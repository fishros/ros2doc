<!DOCTYPE html>
<html class="writer-html5" lang="zh" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ament_cmake用户文档 &mdash; ROS 2 documentation  文档</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://docs.ros.org/en/How-To-Guides/Ament-CMake-Documentation.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="ament_cmake_python用户文档 [小鱼@5911]" href="Ament-CMake-Python-Documentation.html" />
    <link rel="prev" title="开发ROS 2包 [待校准@6065]" href="Developing-a-ROS-2-Package.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> ROS 2 documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">安装</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Installation/Ubuntu-Development-Setup.html">在Ubuntu Linux上构建ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/Ubuntu-Install-Binary.html">在Ubuntu Linux上安装ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/Ubuntu-Install-Debians.html">通过Debian包安装ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/macOS-Development-Setup.html">在macOS上构建ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/macOS-Install-Binary.html">在macOS上安装ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/Windows-Development-Setup.html">在Windows上构建ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/Windows-Install-Binary.html">在Windows上安装ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/Fedora-Development-Setup.html">在Fedora Linux上构建ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/Latest-Development-Setup.html">安装最新的ROS 2开发版本</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/Maintaining-a-Source-Checkout.html">维护ROS 2Foxy源文件的检出</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/Testing.html">用于测试的替代安装源</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation/DDS-Implementations.html">安装DDS实现</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Installation/DDS-Implementations/Install-Connext-Security-Plugins.html">安装Connext安全插件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Installation/DDS-Implementations/Install-Connext-University-Eval.html">安装RTI Connext DDS的大学或评估版本 [Alyssa&#64;5370]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Installation/DDS-Implementations/Working-with-Eclipse-CycloneDDS.html">使用Eclipse Cyclone DDS [Alyssa&#64;5384]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Installation/DDS-Implementations/Working-with-GurumNetworks-GurumDDS.html">使用GurumNetworks GurumDDS [Alyssa&#64;5400]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Installation/DDS-Implementations/Working-with-eProsima-Fast-DDS.html">使用eProsima Fast DDS [Alyssa&#64;5417]</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Docs-Guide.html">文档指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials.html">教程</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Configuring-ROS2-Environment.html">配置ROS 2环境</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Turtlesim/Introducing-Turtlesim.html">介绍turtlesim和rqt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Understanding-ROS2-Nodes.html">了解ROS 2节点 [待校准&#64;9173]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Topics/Understanding-ROS2-Topics.html">理解ROS 2话题 [待校准&#64;8808]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Services/Understanding-ROS2-Services.html">了解ROS 2服务 [待校准&#64;8182]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Parameters/Understanding-ROS2-Parameters.html">理解ROS 2参数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Understanding-ROS2-Actions.html">理解ROS 2动作 [待校准&#64;9124]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Rqt-Console/Using-Rqt-Console.html">使用rqt_控制台 [待校准&#64;8152]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Launch/CLI-Intro.html">介绍ROS 2launch [待校准&#64;7541]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Ros2bag/Recording-And-Playing-Back-Data.html">记录和回放数据 [待校准&#64;8079]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Workspace/Creating-A-Workspace.html">创建工作空间 [待校准&#64;9276]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Creating-Your-First-ROS2-Package.html">创建您的第一个ROS 2包 [待校准&#64;7117]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">编写简单的发布者和订阅者 (c ++) [待校准&#64;9345]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Writing-A-Simple-Py-Publisher-And-Subscriber.html">编写简单的发布者和订阅者 (Python) [待校准&#64;9432]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Writing-A-Simple-Cpp-Service-And-Client.html">编写简单的服务和客户端 (c ++) [待校准&#64;9393]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Writing-A-Simple-Py-Service-And-Client.html">编写简单的服务和客户端 (Python) [待校准&#64;9468]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Custom-ROS2-Interfaces.html">创建自定义ROS 2 msg 和 srv 文件 [待校准&#64;7179]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Single-Package-Define-And-Use-Interface.html">在ROS 2接口上扩展 [待校准&#64;8284]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Using-Parameters-In-A-Class-CPP.html">在类 (c ++) 中使用参数 [待校准&#64;9209]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Using-Parameters-In-A-Class-Python.html">在类中使用参数 (Python) [待校准&#64;9249]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Getting-Started-With-Ros2doctor.html">开始使用ros2doctor [待校准&#64;7450]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Pluginlib.html">创建和使用插件 (c ++) [待校准&#64;7851]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Actions/Creating-an-Action.html">创建动作 [待校准&#64;6711]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.html">编写动作服务器和客户端 (c ++) [待校准&#64;6753]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Actions/Writing-a-Py-Action-Server-Client.html">编写动作服务器和客户端 (Python) [待校准&#64;6825]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Composition.html">在单个进程中组成多个节点 [待校准&#64;7034]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Colcon-Tutorial.html">使用colcon构建包 [待校准&#64;6975]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Launch/Launch-Main.html">Launch教程 [待校准&#64;7600]</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Launch/Creating-Launch-Files.html">创建launch文件 [待校准&#64;7562]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Launch/Launch-system.html">[需手动修复的语法]Launch/监控多节点[需手动修复的语法]Launch [待校准&#64;7614]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Launch/Using-Substitutions.html">在launch文件中使用替换 [待校准&#64;7737]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Launch/Using-Event-Handlers.html">在launch文件中使用事件处理程序 [待校准&#64;7641]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Launch/Using-ROS2-Launch-For-Large-Projects.html">在大型项目中使用ROS 2launch [待校准&#64;7674]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Tf2/Tf2-Main.html">tf2教程 [待校准&#64;8518]</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Introduction-To-Tf2.html">tf2简介 [待校准&#64;8434]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Writing-A-Tf2-Static-Broadcaster-Py.html">编写tf2静态广播器 (Python) [待校准&#64;8739]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Writing-A-Tf2-Static-Broadcaster-Cpp.html">编写tf2静态广播器 (c ++) [待校准&#64;8697]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Writing-A-Tf2-Broadcaster-Py.html">编写tf2广播器 (Python) [待校准&#64;8660]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Writing-A-Tf2-Broadcaster-Cpp.html">编写tf2广播器 (c ++) [待校准&#64;8621]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Writing-A-Tf2-Listener-Py.html">编写tf2监听程序 (Python) [待校准&#64;8691]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Writing-A-Tf2-Listener-Cpp.html">编写tf2监听程序 (c ++) [待校准&#64;8673]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Adding-A-Frame-Py.html">添加帧 (Python) [待校准&#64;8390]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Adding-A-Frame-Cpp.html">添加帧 (c ++) [待校准&#64;8354]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Learning-About-Tf2-And-Time-Py.html">学习tf2和时间 (Python) [待校准&#64;8480]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Learning-About-Tf2-And-Time-Cpp.html">学习tf2和时间 (c ++) [待校准&#64;8463]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Time-Travel-With-Tf2-Py.html">时间穿梭tf2 (Python) [待校准&#64;8570]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Time-Travel-With-Tf2-Cpp.html">时间穿梭带tf2 (C++) [待校准&#64;8545]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Debugging-Tf2-Problems.html">调试tf2问题 [待校准&#64;8396]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Quaternion-Fundamentals.html">四元数基金amentals [待校准&#64;8494]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/Tf2/Using-Stamped-Datatypes-With-Tf2-Ros-MessageFilter.html">使用stamped数据类型与tf2_ros: MessageFilter [待校准&#64;8578]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/URDF/URDF-Main.html">URDF教程 [待校准&#64;9047]</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/URDF/Building-a-Visual-Robot-Model-with-URDF-from-Scratch.html">从头开始用URDF构建视觉机器人模型 [待校准&#64;8996]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/URDF/Building-a-Movable-Robot-Model-with-URDF.html">用URDF建立可移动机器人模型 [待校准&#64;8974]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/URDF/Adding-Physical-and-Collision-Properties-to-a-URDF-Model.html">向URDF模型添加物理和碰撞属性 [待校准&#64;8927]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/URDF/Using-Xacro-to-Clean-Up-a-URDF-File.html">使用Xacro清理URDF文件 [待校准&#64;9075]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tutorials/URDF/Using-URDF-with-Robot-State-Publisher.html">将URDF与robot_state_发布者结合使用 [待校准&#64;9049]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Topics/Topic-Statistics-Tutorial.html">ROS 2话题统计教程 (c ++) [待校准&#64;8751]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Discovery-Server/Discovery-Server.html">使用Fast DDS Discovery Server作为发现协议 [社区贡献] [待校准&#64;7319]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Allocator-Template-Tutorial.html">实现自定义内存分配器 [待校准&#64;6885]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Simulators/Webots/Setting-up-a-Robot-Simulation-Webots.html">设置机器人仿真 (Webots) [待校准&#64;8222]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Deploying-ROS-2-on-IBM-Cloud.html">IBM Cloud Kubernetes上的ROS2 [社区-贡献] [待校准&#64;7232]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Eclipse-Oxygen-with-ROS-2-and-rviz2.html">带有ROS 2和rviz2的Eclipse Oxygen [社区贡献] [待校准&#64;7387]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Building-Realtime-rt_preempt-kernel-for-ROS-2.html">为ROS 2构建实时Linux [社区-贡献] [待校准&#64;6954]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Ros2bag/Recording-A-Bag-From-Your-Own-Node.html">从您自己的节点记录一个包 [待校准&#64;7994]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Building-ROS2-Package-with-eclipse-2021-06.html">使用eclipse 2021-06构建ROS 2包 [待校准&#64;6926]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Quality-of-Service.html">使用服务质量设置处理有损网络 [待校准&#64;7902]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Managed-Nodes.html">具有托管生命周期的节点管理 [待校准&#64;7809]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Intra-Process-Communication.html">高效的流程内通讯 [待校准&#64;7491]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Rosbag-with-ROS1-Bridge.html">使用ROS 1bridge用rosbag记录和回放话题数据 [待校准&#64;8125]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Real-Time-Programming.html">ROS 2中的实时编程 [待校准&#64;7931]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/dummy-robot-demo.html">尝试dummy robot例程 [待校准&#64;9496]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tutorials/Logging-and-logger-configuration.html">日志和日志记录器配置例程 [待校准&#64;7762]</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../How-To-Guides.html">问题指南</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Installation-Troubleshooting.html">安装故障诊断工具 [待校准&#64;6086]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Developing-a-ROS-2-Package.html">开发ROS 2包 [待校准&#64;6065]</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ament_cmake用户文档</a></li>
<li class="toctree-l2"><a class="reference internal" href="Ament-CMake-Python-Documentation.html">ament_cmake_python用户文档 [小鱼&#64;5911]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Launch-files-migration-guide.html">迁移launch文件ROS 1ROS 2 [待校准&#64;6189]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Launch-file-different-formats.html">对ROS 2Launch文件使用Python、XML和YAML [待校准&#64;6162]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Launching-composable-nodes.html">使用ROS 2launch到launch可组合节点 [待校准&#64;6284]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Parameters-YAML-files-migration-guide.html">将YAML参数文件从ROS 1迁移到ROS 2 [待校准&#64;6401]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Node-arguments.html">通过命令行将ROS参数传递给节点 [待校准&#64;6297]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Sync-Vs-Async.html">同步与异步服务客户端 [待校准&#64;6523]</a></li>
<li class="toctree-l2"><a class="reference internal" href="DDS-tuning.html">DDS调优指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overriding-QoS-Policies-For-Recording-And-Playback.html">rosbag2: 重载QoS策略 [待校准&#64;6323]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Working-with-multiple-RMW-implementations.html">使用多个ROS 2中间件实现 [待校准&#64;6619]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Cross-compilation.html">交叉编译 [待校准&#64;5934]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Releasing-a-ROS-2-package-with-bloom.html">发布带有bloom的ROS 2包 [待校准&#64;6488]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Using-Python-Packages.html">将Python包与ROS 2结合使用 [待校准&#64;6562]</a></li>
<li class="toctree-l2"><a class="reference internal" href="RQt-Port-Plugin-Windows.html">将RQt插件移植到Windows [待校准&#64;6413]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Run-2-nodes-in-single-or-separate-docker-containers.html">在Docker中运行ROS 2节点 [社区-贡献] [待校准&#64;6510]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Package-maintainer-guide.html">ROS 2包维护者指南 [待校准&#64;6336]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Building-a-Custom-Debian-Package.html">构建自定义Debian包</a></li>
<li class="toctree-l2"><a class="reference internal" href="Topics-Services-Actions.html">话题vs服务vs动作 [小鱼&#64;6548]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Using-Variants.html">使用变体 [待校准&#64;6582]</a></li>
<li class="toctree-l2"><a class="reference internal" href="Using-ros2-param.html">使用 <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">param</span></code> 命令行工具 [待校准&#64;6597]</a></li>
<li class="toctree-l2"><a class="reference internal" href="RQt-Source-Install.html">从源码构建RQt</a><ul>
<li class="toctree-l3"><a class="reference internal" href="RQt-Source-Install-MacOS.html">在macOS上从源文件构建RQt [待校准&#64;6459]</a></li>
<li class="toctree-l3"><a class="reference internal" href="RQt-Source-Install-Windows10.html">在Windows 10上从源文件构建RQt [待校准&#64;6467]</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Concepts.html">概念</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Domain-ID.html">ROS_DOMAIN_ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Different-Middleware-Vendors.html">关于不同的ROS 2 DDS/RTPS供应商</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Logging.html">关于日志和日志记录器配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Quality-of-Service-Settings.html">关于服务质量(QOS)设置 [小鱼&#64;9945]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-ROS-2-Client-Libraries.html">关于ROS 2客户端库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-ROS-Interfaces.html">关于ROS 2接口 [待校准&#64;10102]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-ROS-2-Parameters.html">关于ROS 2中的参数 [待校准&#64;10066]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Executors.html">执行器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Topic-Statistics.html">关于话题统计</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Command-Line-Tools.html">使用命令行工具进行自检</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-RQt.html">RQt的概述和使用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Composition.html">关于组件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Catment.html">ament和catkin的混合研究(catment) [Alyssa&#64;9595]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Cross-Compilation.html">关于交叉编译</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Tf2.html">关于tf2 [待校准&#64;10229]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Build-System.html">关于构建系统 [待校准&#64;9545]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Internal-Interfaces.html">关于内部ROS 2接口 [待校准&#64;9841]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Middleware-Implementations.html">关于ROS 2中间件实现 [待校准&#64;9923]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Concepts/About-Client-Interfaces.html">ROS 2客户端接口 (客户端库) [待校准&#64;9655]</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Contributing.html">贡献</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Contributing/Developer-Guide.html">ROS 2开发人员指南 [待校准&#64;449]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Contributing/Code-Style-Language-Versions.html">代码样式和语言版本 [待校准&#64;231]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Contributing/Quality-Guide.html">质量指南: 确保代码质量 [待校准&#64;1031]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Contributing/Migration-Guide.html">从ROS 1迁移指南 [待校准&#64;799]</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Contributing/Migration-Guide-Python.html">来自ROS 1的Python迁移指南 [待校准&#64;1022]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Contributing/Build-Farms.html">ROS Build Farms [待校准&#64;186]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Contributing/Windows-Tips-and-Tricks.html">Windows提示和技巧 [待校准&#64;1124]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Contributing/Contributing-To-ROS-2-Documentation.html">为ROS 2文档做出贡献 [待校准&#64;385]</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Contact.html">联系</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROSCon-Content.html">ROSCon内容</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Releases.html">发行版</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Alpha-Overview.html">ROS 2 α 发行版本 (2015年8月-2016年10月) [待校准&#64;1527]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Beta1-Overview.html">贝塔1 (代号'Asphalt'; 2016年12月) [待校准&#64;1607]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Beta2-Overview.html">贝塔2 (代号'r2b2'; 2017年7月) [待校准&#64;1641]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Beta3-Overview.html">贝塔3 (代号'r2b3'; 2017年9月) [待校准&#64;1672]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Release-Ardent-Apalone.html">ROS 2Ardent阿帕隆 (代号'ardent'; 2017年12月) [待校准&#64;4310]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Release-Bouncy-Bolson.html">ROS 2 Bouncy Bolson (代号'bouncy'; 2018年6月) [待校准&#64;4351]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Release-Crystal-Clemmys.html">ROS 2Crystal Clemmys (代号'crystal'; 2018年12月) [待校准&#64;4379]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Release-Dashing-Diademata.html">ROS 2DashingDiademata (代号'dashing'; 2019年5月31日) [待校准&#64;4458]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Release-Eloquent-Elusor.html">ROS 2EloquentElusor (代号'eloquent'; 2019年11月22日) [待校准&#64;4648]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Release-Foxy-Fitzroy.html">ROS 2FoxyFitzroy (代号'foxy'; 2020年6月5日) [待校准&#64;4724]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Release-Galactic-Geochelone.html">ROS 2GalacticGeochelone (代号'galactic'; 2021年5月) [待校准&#64;4870]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Galactic-Geochelone-Complete-Changelog.html">ROS 2GalacticGeochelone完整变更日志 [待校准&#64;1691]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Release-Humble-Hawksbill.html">ROS 2Humble Hawksbill (代号'humble'; 2022年5月) [待校准&#64;5066]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Releases/Release-Rolling-Ridley.html">ROS 2Rolling Ridley (代号'rolling'; 2020年6月) [待校准&#64;5150]</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Features.html">功能状态</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Roadmap.html">开发计划（Roadmap）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Feature-Ideas.html">功能理念</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Governance.html">项目管理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Governance/ROS2-TSC-Charter.html">ROS 2技术指导委员会章程</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Governance/ROS2-TSC-Intake-process.html">ROS 2 TSC申请人加入流程 [小鱼&#64;1387]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Governance/How-To-Start-A-Community-Working-Group.html">如何成立社区工作组 [待校准&#64;1272]</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Marketing.html">营销材料</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Related-Projects.html">相关项目</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Related-Projects/Intel-ROS2-Projects.html">Intel ROS2 项目</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Related-Projects/Nvidia-ROS2-Projects.html">NVIDIA ROS 2 项目</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Glossary.html">相关术语</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ROS 2 documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../How-To-Guides.html">问题指南</a> &raquo;</li>
      <li>ament_cmake用户文档</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ros2/ros2_documentation/blob/foxy/source/How-To-Guides/Ament-CMake-Documentation.rst" class="fa fa-github"> 在 GitHub 上修改</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             


  <div class="section" id="ament-cmake-user-documentation">
<h1>ament_cmake用户文档<a class="headerlink" href="#ament-cmake-user-documentation" title="永久链接至标题"></a></h1>
<p>[需手动修复的语法]ament _ cmake是ROS 2中基于CMake的包的构建系统 (特别是，它将用于大多数 (如果不是全部的话) C/cmake项目)。它是一组增强CMake并为包作者添加便利功能的脚本。了解 <a class="reference external" href="https://cmake.org/cmake/help/v3.5/">CMake</a> will be very helpful, an official tutorial can be found <a class="reference external" href="https://cmake.org/cmake-tutorial/">here</a> 的基本知识。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5760">[待校准&#64;5760]</a></p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">目录</p>
<ul class="simple">
<li><p><a class="reference internal" href="#basics" id="id1">基础知识 [待校准&#64;5762]</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-project-outline" id="id2">基本项目大纲 [待校准&#64;5764]</a></p></li>
<li><p><a class="reference internal" href="#adding-files-and-headers" id="id3">添加文件和标题 [待校准&#64;5776]</a></p></li>
<li><p><a class="reference internal" href="#adding-dependencies" id="id4">添加依赖项 [待校准&#64;5785]</a></p></li>
<li><p><a class="reference internal" href="#building-a-library" id="id5">构建一个库</a></p></li>
<li><p><a class="reference internal" href="#compiler-and-linker-options" id="id6">编译器和链接器选项 [待校准&#64;5810]</a></p></li>
<li><p><a class="reference internal" href="#building-libraries-on-windows" id="id7">在Windows上构建库 [待校准&#64;5818]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#testing-and-linting" id="id8">测试和脱毛 [待校准&#64;5825]</a></p>
<ul>
<li><p><a class="reference internal" href="#linting" id="id9">林廷 [待校准&#64;5827]</a></p></li>
<li><p><a class="reference internal" href="#testing" id="id10">测试 [待校准&#64;5831]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#extending-ament" id="id11">延伸ament [待校准&#64;5844]</a></p>
<ul>
<li><p><a class="reference internal" href="#adding-a-function-macro-to-ament" id="id12">向ament添加函数/宏 [待校准&#64;5846]</a></p></li>
<li><p><a class="reference internal" href="#adding-to-extension-points" id="id13">添加到扩展点 [待校准&#64;5850]</a></p></li>
<li><p><a class="reference internal" href="#adding-extension-points" id="id14">添加扩展点 [待校准&#64;5860]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#adding-resources" id="id15">添加re源文件 [待校准&#64;5866]</a></p>
<ul>
<li><p><a class="reference internal" href="#the-ament-index-explained" id="id16">ament指数解释 [待校准&#64;5869]</a></p></li>
<li><p><a class="reference internal" href="#querying-the-ament-index" id="id17">查询ament指数 [待校准&#64;5877]</a></p></li>
<li><p><a class="reference internal" href="#adding-to-the-ament-index" id="id18">添加到ament指数 [待校准&#64;5889]</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="basics">
<h2>基础知识 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5762">[待校准&#64;5762]</a><a class="headerlink" href="#basics" title="永久链接至标题"></a></h2>
<p>可以在命令行上使用 <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">pkg</span> <span class="pre">create</span> <span class="pre">&lt;package_name&gt;</span></code> 生成基本的CMake大纲。然后将基本构建信息收集在两个文件中:  <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> 和 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 。 <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> 必须包含所有依赖项和一些元数据，以允许colcon为您的包找到正确的构建顺序，在CI中安装所需的依赖项，并为 <code class="docutils literal notranslate"><span class="pre">bloom</span></code> 版本提供信息。 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 包含构建和打包可执行文件和库的命令，并将成为本文档的主要重点。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5763">[待校准&#64;5763]</a></p>
<div class="section" id="basic-project-outline">
<h3>基本项目大纲 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5764">[待校准&#64;5764]</a><a class="headerlink" href="#basic-project-outline" title="永久链接至标题"></a></h3>
<p>基本轮廓 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 的ament包包含: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5765">[待校准&#64;5765]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span> <span class="s">3.5</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">my_project</span><span class="p">)</span>

<span class="nb">ament_package</span><span class="p">()</span>
</pre></div>
</div>
<p>[需手动修复的语法] <code class="docutils literal notranslate"><span class="pre">project</span></code> 的参数将是包装名称，并且必须与 <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> 中的包装名称相同。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5766">[待校准&#64;5766]</a></p>
<p>项目设置由 <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code> 完成，每个包必须进行一次调用。 <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code> 安装 <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> ，将包注册到ament索引，并为CMake安装配置 (可能还有目标) 文件，以便其他使用 <code class="docutils literal notranslate"><span class="pre">find_package</span></code> 的包可以找到它。因为 <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code> 从 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 收集了很多信息，所以它应该是你 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 的最后一次调用。虽然可调用的 <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code> 通过调用的 <code class="docutils literal notranslate"><span class="pre">install</span></code> 功能复制文件和目录，简单只是保持 <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code> 最后调用。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5767">[待校准&#64;5767]</a></p>
<p>[需手动修复的语法]``ament_package`` can被给予额外的论据: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5768">[待校准&#64;5768]</a></p>
<ul class="simple">
<li><p>包装的客户应该可以得到``CONFIG_EXTRAS``: a list of CMake files (<code class="docutils literal notranslate"><span class="pre">.cmake</span></code> or <code class="docutils literal notranslate"><span class="pre">.cmake.in</span></code> templates expanded by <code class="docutils literal notranslate"><span class="pre">configure_file()</span></code>)。有关何时使用这些参数的示例，请参阅 “添加源文件 <a class="reference external" href="https://cmake.org/cmake/help/v3.5/command/configure_file.html">_. For more information on how to use template files, see `the official documentation</a> ” 中的讨论。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5769">[待校准&#64;5769]</a></p></li>
<li><p>后来包括``CONFIG_EXTRAS_POST``: same as <code class="docutils literal notranslate"><span class="pre">CONFIG_EXTRAS</span></code>, but the order in which the files are added differs. While <code class="docutils literal notranslate"><span class="pre">CONFIG_EXTRAS</span></code> files are included before the files generated for the <code class="docutils literal notranslate"><span class="pre">ament_export_*</span></code> calls the files from <code class="docutils literal notranslate"><span class="pre">CONFIG_EXTRAS_POST</span></code> are。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5770">[待校准&#64;5770]</a></p></li>
</ul>
<p>除了添加到 <code class="docutils literal notranslate"><span class="pre">ament_package</span></code> ，您还可以添加到变量 “${PROJECT_NAME}_ CONFIG _ EXTRAS `` and ``  ${PROJECT_NAME}_ CONFIG_EXTRAS_POST”，具有相同的效果。唯一的区别是文件的添加顺序，总顺序如下: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5771">[待校准&#64;5771]</a></p>
<ul class="simple">
<li><p>files added by <code class="docutils literal notranslate"><span class="pre">CONFIG_EXTRAS</span></code></p></li>
<li><p>通过附加到 “${PROJECT_NAME}_ CONFIG_EXTRAS” 来添加的文件 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5773">[待校准&#64;5773]</a></p></li>
<li><p>通过附加到 “${PROJECT_NAME}_ CONFIG_EXTRAS_POST” 来添加的文件 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5774">[待校准&#64;5774]</a></p></li>
<li><p>files added by <code class="docutils literal notranslate"><span class="pre">CONFIG_EXTRAS_POST</span></code></p></li>
</ul>
</div>
<div class="section" id="adding-files-and-headers">
<h3>添加文件和标题 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5776">[待校准&#64;5776]</a><a class="headerlink" href="#adding-files-and-headers" title="永久链接至标题"></a></h3>
<p>构建的主要目标有两个: 分别由 <code class="docutils literal notranslate"><span class="pre">add_library</span></code> 和 <code class="docutils literal notranslate"><span class="pre">add_executable</span></code> 构建的库和可执行文件。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5777">[待校准&#64;5777]</a></p>
<p>随着头文件的分离和在C/C ++ 中的实现，并不总是需要将两个文件都添加为 <code class="docutils literal notranslate"><span class="pre">add_library</span></code> /  <code class="docutils literal notranslate"><span class="pre">add_executable</span></code> 的参数。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5778">[待校准&#64;5778]</a></p>
<p>提出以下最佳实践: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5779">[待校准&#64;5779]</a></p>
<ul class="simple">
<li><p>如果您正在构建一个库，请将客户端应该可以使用的所有标头放入 <code class="docutils literal notranslate"><span class="pre">include</span></code> 文件夹的子目录中，该文件夹的名称类似于包，而所有其他文件 (不应导出的 <code class="docutils literal notranslate"><span class="pre">.c/.cpp</span></code> 文件和头文件) 都在 <code class="docutils literal notranslate"><span class="pre">src</span></code> 文件夹中。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5780">[待校准&#64;5780]</a></p></li>
<li><p>只有cpp文件在对 <code class="docutils literal notranslate"><span class="pre">add_library</span></code> 或 <code class="docutils literal notranslate"><span class="pre">add_executable</span></code> 的调用中被明确引用。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5781">[待校准&#64;5781]</a></p></li>
<li><p>允许通过 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5782">[待校准&#64;5782]</a></p></li>
</ul>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">my_target</span>
  <span class="s">PUBLIC</span>
    <span class="o">$&lt;</span><span class="nv">BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include</span><span class="o">&gt;</span>
    <span class="o">$&lt;</span><span class="nv">INSTALL_INTERFACE:include</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>安装时，这会添加文件夹 “${CMAKE_CURRENT_SOURCE_DIR}/包含 `` to the public interface during build time and all files in the include folder (relative to ``  ${CMAKE_INSTALL_DIR}” 中的所有文件。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5783">[待校准&#64;5783]</a></p>
<p>原则上，使用生成器表达式不是必要如果文件夹调用ed <code class="docutils literal notranslate"><span class="pre">include</span></code> 和顶级关于 ''${CMAKE_CURRENT_SOURCE_DIR} `` and ``  ${CMAKE_INSTALL_DIR}'', 但很普通。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5784">[待校准&#64;5784]</a></p>
</div>
<div class="section" id="adding-dependencies">
<h3>添加依赖项 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5785">[待校准&#64;5785]</a><a class="headerlink" href="#adding-dependencies" title="永久链接至标题"></a></h3>
<p>有两种方法可以将包与新的依赖项链接起来。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5786">[待校准&#64;5786]</a></p>
<p>第一个也是推荐的方法是使用ament宏观 <code class="docutils literal notranslate"><span class="pre">ament_target_dependencies</span></code> 。例如，假设我们想将 <code class="docutils literal notranslate"><span class="pre">my_target</span></code> 与线性代数库特征3联系起来。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5787">[待校准&#64;5787]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">Eigen3</span> <span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">my_target</span> <span class="s">Eigen3</span><span class="p">)</span>
</pre></div>
</div>
<p>它包括项目要正确找到的必要的标头和库及其依赖项。它还将确保在使用覆盖工作区时正确排序所有依赖项的包含目录。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5788">[待校准&#64;5788]</a></p>
<p>第二种方法是使用 <code class="docutils literal notranslate"><span class="pre">target_link_libraries</span></code> 。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5789">[待校准&#64;5789]</a></p>
<p>在现代CMake中推荐的方法是只使用目标，导出和链接目标。CMake目标是命名空间，类似于C++。例如， <code class="docutils literal notranslate"><span class="pre">Eigen3</span></code> 定义了目标 “本征3:: 本征”。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5790">[待校准&#64;5790]</a></p>
<p>至少直到 <code class="docutils literal notranslate"><span class="pre">Crystal</span> <span class="pre">Clemmys</span></code> 目标名称不支持 <code class="docutils literal notranslate"><span class="pre">ament_target_dependencies</span></code> 微距。有时需要调用 <code class="docutils literal notranslate"><span class="pre">target_link_libaries</span></code> CMake函数。在本征3的示例中，调用应该看起来像 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5791">[待校准&#64;5791]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">Eigen3</span> <span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">my_target</span> <span class="s">Eigen3::Eigen</span><span class="p">)</span>
</pre></div>
</div>
<p>这还将包括必要的标头、库及其依赖项，但与 <code class="docutils literal notranslate"><span class="pre">ament_target_dependencies</span></code> 相比，在使用覆盖工作区时，它可能无法正确排序依赖项。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5792">[待校准&#64;5792]</a></p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>它不应该必须 <code class="docutils literal notranslate"><span class="pre">find_package</span></code> 库不明确需要但依赖另一个依赖明确需要。如果是这种情况，请针对相应的包提交错误。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5793">[待校准&#64;5793]</a></p>
</div>
</div>
<div class="section" id="building-a-library">
<h3><a class="toc-backref" href="#id5">构建一个库</a><a class="headerlink" href="#building-a-library" title="永久链接至标题"></a></h3>
<p>构建可重用的库时，需要导出一些信息，以便下游包轻松使用。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5795">[待校准&#64;5795]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">ament_export_targets</span><span class="p">(</span><span class="s">my_libraryTargets</span> <span class="s">HAS_LIBRARY_TARGET</span><span class="p">)</span>
<span class="nb">ament_export_dependencies</span><span class="p">(</span><span class="s">some_dependency</span><span class="p">)</span>

<span class="nb">install</span><span class="p">(</span>
  <span class="s">DIRECTORY</span> <span class="s">include/</span>
  <span class="s">DESTINATION</span> <span class="s">include</span>
<span class="p">)</span>

<span class="nb">install</span><span class="p">(</span>
  <span class="s">TARGETS</span> <span class="s">my_library</span>
  <span class="s">EXPORT</span> <span class="s">my_libraryTargets</span>
  <span class="s">LIBRARY</span> <span class="s">DESTINATION</span> <span class="s">lib</span>
  <span class="s">ARCHIVE</span> <span class="s">DESTINATION</span> <span class="s">lib</span>
  <span class="s">RUNTIME</span> <span class="s">DESTINATION</span> <span class="s">bin</span>
  <span class="s">INCLUDES</span> <span class="s">DESTINATION</span> <span class="s">include</span>
<span class="p">)</span>
</pre></div>
</div>
<p>在这里，我们假设文件夹 <code class="docutils literal notranslate"><span class="pre">include</span></code> 包含需要导出的标题。请注意，没有必要将所有标头放入单独的文件夹中，只需要将那些标头包含在客户端中。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5796">[待校准&#64;5796]</a></p>
<p>下面是上面片段中发生的事情: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5797">[待校准&#64;5797]</a></p>
<ul class="simple">
<li><p>[需手动修复的语法] <code class="docutils literal notranslate"><span class="pre">ament_export_targets</span></code> 宏观出口CMake的目标。这是允许库的客户端使用 “target_link_library (客户端my_library::my_library)” 语法所必需的。[需手动修复的语法] <code class="docutils literal notranslate"><span class="pre">ament_export_targets</span></code> 可以在安装调用中采用名为 <code class="docutils literal notranslate"><span class="pre">EXPORT</span></code> 的任意目标列表和一个附加选项 <code class="docutils literal notranslate"><span class="pre">HAS_LIBRARY_TARGET</span></code> ，这将潜在的库添加到环境变量中。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5798">[待校准&#64;5798]</a></p></li>
<li><p>[需手动修复的语法] <code class="docutils literal notranslate"><span class="pre">ament_export_dependencies</span></code> 将依赖项导出到下游包。这是必要的，这样库的用户也不必为这些依赖项调用 <code class="docutils literal notranslate"><span class="pre">find_package</span></code> 。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5799">[待校准&#64;5799]</a></p></li>
<li><p>第一个 <code class="docutils literal notranslate"><span class="pre">install</span></code> 命令安装应该对客户端可用的头文件。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5800">[待校准&#64;5800]</a></p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>从CMake子目录调用 <code class="docutils literal notranslate"><span class="pre">ament_export_targets</span></code> 、 <code class="docutils literal notranslate"><span class="pre">ament_export_dependencies</span></code> 或其他ament命令将无法正常工作。这是因为CMake子目录无法在调用 <code class="docutils literal notranslate"><span class="pre">ament_package</span></code> 的父范围内设置必要的变量。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5801">[待校准&#64;5801]</a></p>
</div>
<ul class="simple">
<li><p>最后一个大型安装命令安装库。档案和库文件将被导出到lib文件夹，运行时二进制文件将被安装到bin文件夹，并且安装的标题的路径是 <code class="docutils literal notranslate"><span class="pre">include</span></code> 。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5802">[待校准&#64;5802]</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>Windows dll被视为运行时工件，并安装到 <code class="docutils literal notranslate"><span class="pre">RUNTIME</span> <span class="pre">DESTINATION</span></code> 文件夹中。因此，即使在基于Unix的系统上开发库时，也建议不要忽略 <code class="docutils literal notranslate"><span class="pre">RUNTIME</span></code> 安装。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5803">[待校准&#64;5803]</a></p>
</div>
<ul class="simple">
<li><p>关于 <code class="docutils literal notranslate"><span class="pre">include</span> <span class="pre">directory</span></code> ，安装命令只向CMake添加信息，它实际上并没有安装包含文件夹。如上所述，通过 <code class="docutils literal notranslate"><span class="pre">install(DIRECTORY</span> <span class="pre">&lt;dir&gt;</span> <span class="pre">DESTINATION</span> <span class="pre">&lt;dest&gt;)</span></code> 复制标题来完成。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5804">[待校准&#64;5804]</a></p></li>
<li><p>安装调用的 <code class="docutils literal notranslate"><span class="pre">EXPORT</span></code> 符号需要额外注意: 它为 <code class="docutils literal notranslate"><span class="pre">my_library</span></code> 目标安装CMake文件。它的名字和 <code class="docutils literal notranslate"><span class="pre">ament_export_targets</span></code> 的论点一模一样，可以像图书馆一样命名。然而，这将禁止使用 <code class="docutils literal notranslate"><span class="pre">ament_target_dependencies</span></code> 的方式包括你的图书馆。为了实现充分的灵活性，建议在出口目标之前添加类似 <code class="docutils literal notranslate"><span class="pre">&lt;target&gt;Targets</span></code> 的内容。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5805">[待校准&#64;5805]</a></p></li>
<li><p>所有安装路径都是相对于 <code class="docutils literal notranslate"><span class="pre">CMAKE_INSTALL_PREFIX</span></code> 的，它已经由colcon/ament正确设置 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5806">[待校准&#64;5806]</a></p></li>
</ul>
<p>有两个附加功能可以使用，但对于基于目标的安装来说是多余的: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5807">[待校准&#64;5807]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">ament_export_include_directories</span><span class="p">(</span><span class="s">include</span><span class="p">)</span>
<span class="nb">ament_export_libraries</span><span class="p">(</span><span class="s">my_library</span><span class="p">)</span>
</pre></div>
</div>
<p>第一个宏标记导出的包含目录的目录 (这是由目标 <code class="docutils literal notranslate"><span class="pre">install</span></code> 调用中的 <code class="docutils literal notranslate"><span class="pre">INCLUDES</span> <span class="pre">DESTINATION</span></code> 实现的)。第二个宏标记已安装库的位置 (这是通过对 <code class="docutils literal notranslate"><span class="pre">ament_export_targets</span></code> 的调用中的 <code class="docutils literal notranslate"><span class="pre">HAS_LIBRARY_TARGET</span></code> 参数完成的)。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5808">[待校准&#64;5808]</a></p>
<p>对于非目标导出，有些宏可以采用不同类型的参数，但是由于现代Make推荐的方法是使用目标，因此我们在这里不介绍它们。这些选项的文档可以在源文件本身中找到。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5809">[待校准&#64;5809]</a></p>
</div>
<div class="section" id="compiler-and-linker-options">
<h3>编译器和链接器选项 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5810">[待校准&#64;5810]</a><a class="headerlink" href="#compiler-and-linker-options" title="永久链接至标题"></a></h3>
<p>ROS 2目标编译器符合C++ 14 C99标准直到至少 <code class="docutils literal notranslate"><span class="pre">Crystal</span> <span class="pre">Clemmys</span></code> 。较新的版本可能是未来的目标，并被引用为 <a class="reference external" href="https://www.ros.org/reps/rep-2000.html">here</a> 。因此，通常设置相应的CMake标志: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5811">[待校准&#64;5811]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">if</span><span class="p">(</span><span class="s">NOT</span> <span class="s">CMAKE_C_STANDARD</span><span class="p">)</span>
  <span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_C_STANDARD</span> <span class="s">99</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="nb">if</span><span class="p">(</span><span class="s">NOT</span> <span class="s">CMAKE_CXX_STANDARD</span><span class="p">)</span>
  <span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span> <span class="s">14</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
</pre></div>
</div>
<p>为了保持代码干净，编译器应该对有问题的代码发出警告，并且这些警告应该被修复。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5812">[待校准&#64;5812]</a></p>
<p>建议至少覆盖以下警告级别: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5813">[待校准&#64;5813]</a></p>
<ul class="simple">
<li><p>对于Visual Studio，保留默认的 <code class="docutils literal notranslate"><span class="pre">W1</span></code> 警告 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5814">[待校准&#64;5814]</a></p></li>
<li><p>对于GCC和Clang:  <code class="docutils literal notranslate"><span class="pre">-Wall</span> <span class="pre">-Wextra</span> <span class="pre">-Wpedantic</span></code> 是必需的， <code class="docutils literal notranslate"><span class="pre">-Wshadow</span> <span class="pre">-Werror</span></code> 是可取的 (后者会出现警告错误)。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5815">[待校准&#64;5815]</a></p></li>
</ul>
<p>尽管现代CMake建议在目标基础上添加编译器标志，即调用 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5816">[待校准&#64;5816]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">target_compile_options</span><span class="p">(</span><span class="s">my_target</span> <span class="s">PRIVATE</span> <span class="s">-Wall</span><span class="p">)</span>
</pre></div>
</div>
<p>目前建议使用目录级函数 <code class="docutils literal notranslate"><span class="pre">add_compile_options(-Wall)</span></code> ，以免代码中包含所有可执行文件和测试的基于目标的编译选项。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5817">[待校准&#64;5817]</a></p>
</div>
<div class="section" id="building-libraries-on-windows">
<h3>在Windows上构建库 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5818">[待校准&#64;5818]</a><a class="headerlink" href="#building-libraries-on-windows" title="永久链接至标题"></a></h3>
<p>由于Linux、Mac和Windows都是官方支持的平台，为了产生最大的影响，任何包都应该建立在Windows上。Windows库格式强制执行符号可见性: 应从客户端使用的每个符号都必须由库显式导出 (数据符号需要隐式导入)。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5819">[待校准&#64;5819]</a></p>
<p>为了使其与Clang和GCC构建兼容，建议使用 <a class="reference external" href="https://gcc.gnu.org/wiki/Visibility">the GCC wiki</a> 中的逻辑。将其用于调用ed <code class="docutils literal notranslate"><span class="pre">my_library</span></code> 的包: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5820">[待校准&#64;5820]</a></p>
<ul class="simple">
<li><p>将链接中的逻辑复制到调用ed <code class="docutils literal notranslate"><span class="pre">visibility_control.hpp</span></code> 的头文件中。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5821">[待校准&#64;5821]</a></p></li>
<li><p>用 <code class="docutils literal notranslate"><span class="pre">MY_LIBRARY</span></code> 取代 <code class="docutils literal notranslate"><span class="pre">DLL</span></code>  (例如，见 <a class="reference external" href="https://github.com/ros2/rviz/blob/ros2/rviz_rendering/include/rviz_rendering/visibility_control.hpp">rviz_rendering</a> 能见度控制)。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5822">[待校准&#64;5822]</a></p></li>
<li><p>对需要导出的所有符号使用宏  &quot;MY_LIBRARY_PUBLIC&quot;  (即类或函数)。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5823">[待校准&#64;5823]</a></p></li>
<li><p>在 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 项目中使用: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5824">[待校准&#64;5824]</a></p></li>
</ul>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">target_compile_definitions</span><span class="p">(</span><span class="s">my_library</span> <span class="s">PRIVATE</span> <span class="s2">&quot;MY_LIBRARY_BUILDING_LIBRARY&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="testing-and-linting">
<h2>测试和脱毛 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5825">[待校准&#64;5825]</a><a class="headerlink" href="#testing-and-linting" title="永久链接至标题"></a></h2>
<p>为了将测试与使用colcon构建库分开，将所有调用s包装到linters和测试中，条件如下: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5826">[待校准&#64;5826]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">if</span><span class="p">(</span><span class="s">BUILD_TESTING</span><span class="p">)</span>
  <span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake_gtest</span> <span class="s">REQUIRED</span><span class="p">)</span>
  <span class="nb">ament_add_gtest</span><span class="p">(</span><span class="s">&lt;tests&gt;</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="linting">
<h3>林廷 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5827">[待校准&#64;5827]</a><a class="headerlink" href="#linting" title="永久链接至标题"></a></h3>
<p>建议使用来自 <a class="reference external" href="https://github.com/ament/ament_lint/blob/foxy/ament_lint_auto/doc/index.rst#ament_lint_auto">ament_lint_auto</a> 的组合调用: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5828">[待校准&#64;5828]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_lint_auto</span> <span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">ament_lint_auto_find_test_dependencies</span><span class="p">()</span>
</pre></div>
</div>
<p>这将运行 <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> 中定义的林特。建议使用由 <code class="docutils literal notranslate"><span class="pre">ament_lint_common</span></code> 包装定义的一组短吻鳄。包括在那里的单个漆器，以及它们的功能，可以在 <a class="reference external" href="https://github.com/ament/ament_lint/blob/foxy/ament_lint_common/doc/index.rst">ament_lint_common docs</a> 中看到。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5829">[待校准&#64;5829]</a></p>
<p>[需手动修复的语法]ament提供的短吻鳄也可以单独添加，而不是运行 <code class="docutils literal notranslate"><span class="pre">ament_lint_auto</span></code> 。如何做到这一点的一个例子可以在 <a class="reference external" href="https://github.com/ament/ament_lint/blob/foxy/ament_cmake_lint_cmake/doc/index.rst">ament_cmake_lint_cmake documentation</a> 中找到。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5830">[待校准&#64;5830]</a></p>
</div>
<div class="section" id="testing">
<h3>测试 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5831">[待校准&#64;5831]</a><a class="headerlink" href="#testing" title="永久链接至标题"></a></h3>
<p>[需手动修复的语法]Ament包含CMake宏来简化GTests的设置。呼叫: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5832">[待校准&#64;5832]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake_gtest</span><span class="p">)</span>
<span class="nb">ament_add_gtest</span><span class="p">(</span><span class="s">some_test</span> <span class="s">&lt;test_sources&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>添加GTest。然后，这是一个常规目标，可以与其他库 (例如项目库) 链接。这些宏具有其他参数: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5833">[待校准&#64;5833]</a></p>
<ul class="simple">
<li><p>[需手动修复的语法]``APPEND_ENV``:附加环境变量。例如，您可以通过调用以下命令添加到ament前缀路径: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5834">[待校准&#64;5834]</a></p></li>
</ul>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake_gtest</span> <span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">ament_add_gtest</span><span class="p">(</span><span class="s">some_test</span> <span class="s">&lt;test_sources&gt;</span>
  <span class="s">APPEND_ENV</span> <span class="s">PATH=some/addtional/path/for/testing/resources</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>[需手动修复的语法]``APPEND_LIBRARY_DIRS``: append libraries so that they can be found by the linker at runtime. This can be achieved by setting environment variables like <code class="docutils literal notranslate"><span class="pre">PATH</span></code> on Windows and <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> onLinux，但这使得调用平台特定。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5835">[待校准&#64;5835]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ENV</span></code>: set environment variables (same syntax as <code class="docutils literal notranslate"><span class="pre">APPEND_ENV</span></code>). <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5836">[待校准&#64;5836]</a></p></li>
<li><p>[需手动修复的语法]``TIMEOUT``:将测试超时设置为秒。GTests的默认值为60秒。例如: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5837">[待校准&#64;5837]</a></p></li>
</ul>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">ament_add_gtest</span><span class="p">(</span><span class="s">some_test</span> <span class="s">&lt;test_sources&gt;</span> <span class="s">TIMEOUT</span> <span class="s">120</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>[需手动修复的语法]``SKIP_TEST``:跳过此测试 (将在控制台输出中显示为  &quot;passed&quot; )。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5838">[待校准&#64;5838]</a></p></li>
<li><p>[需手动修复的语法]``SKIP_LINKING_MAIN_LIBRARIES``:与GTest没有联系。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5839">[待校准&#64;5839]</a></p></li>
<li><p>[需手动修复的语法]``WORKING_DIRECTORY``:设置了测试的工作目录。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5840">[待校准&#64;5840]</a></p></li>
</ul>
<p>否则，默认的工作目录是 <code class="docutils literal notranslate"><span class="pre">CMAKE_SOURCE_DIR</span></code> ，它将被评估为顶级 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 的目录。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5841">[待校准&#64;5841]</a></p>
<p>同样，有一个CMake宏来设置GTest，包括GMock: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5842">[待校准&#64;5842]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_gmock</span> <span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">ament_add_gmock</span><span class="p">(</span><span class="s">some_test</span> <span class="s">&lt;test_sources&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>它具有与 <code class="docutils literal notranslate"><span class="pre">ament_add_gtest</span></code> 相同的附加参数。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5843">[待校准&#64;5843]</a></p>
</div>
</div>
<div class="section" id="extending-ament">
<h2>延伸ament <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5844">[待校准&#64;5844]</a><a class="headerlink" href="#extending-ament" title="永久链接至标题"></a></h2>
<p>可以向 <code class="docutils literal notranslate"><span class="pre">ament_cmake</span></code> 注册其他宏/函数，并以多种方式扩展它。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5845">[待校准&#64;5845]</a></p>
<div class="section" id="adding-a-function-macro-to-ament">
<h3>向ament添加函数/宏 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5846">[待校准&#64;5846]</a><a class="headerlink" href="#adding-a-function-macro-to-ament" title="永久链接至标题"></a></h3>
<p>扩展ament通常意味着你希望有一些功能可供其他包使用。向客户包提供宏的最佳方式是向ament注册。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5847">[待校准&#64;5847]</a></p>
<p>这可以通过附加 “${PROJECT_NAME}_ CONFIG_EXTRAS” 变量来完成，该变量由 <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code> 通过 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5848">[待校准&#64;5848]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="s">APPEND</span> <span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="s">_CONFIG_EXTRAS</span>
  <span class="s">path/to/file.cmake</span><span class="s2">&quot;</span>
<span class="s2">  other/pathto/file.cmake&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>或者，您可以直接将文件添加到 <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code> 调用中: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5849">[待校准&#64;5849]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">ament_package</span><span class="p">(</span><span class="s">CONFIG_EXTRAS</span>
  <span class="s">path/to/file.cmake</span>
  <span class="s">other/pathto/file.cmake</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-to-extension-points">
<h3>添加到扩展点 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5850">[待校准&#64;5850]</a><a class="headerlink" href="#adding-to-extension-points" title="永久链接至标题"></a></h3>
<p>除了具有可在其他包中使用的功能的简单文件之外，您还可以向ament添加扩展名。这些扩展是使用定义扩展点的函数执行的脚本。ament扩展最常见的用例可能是注册rosidl消息生成器: 当编写生成器时，您通常希望使用生成器生成所有消息和服务，而无需修改消息/服务定义包的代码。通过将发电机注册为 <code class="docutils literal notranslate"><span class="pre">rosidl_generate_interfaces</span></code> 的延伸，这是可能的。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5851">[待校准&#64;5851]</a></p>
<p>作为示例，请参见 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5852">[待校准&#64;5852]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">ament_register_extension</span><span class="p">(</span>
  <span class="s2">&quot;rosidl_generate_interfaces&quot;</span>
  <span class="s2">&quot;rosidl_generator_cpp&quot;</span>
  <span class="s2">&quot;rosidl_generator_cpp_generate_interfaces.cmake&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>哪个寄存器宏观 <code class="docutils literal notranslate"><span class="pre">rosidl_generator_cpp_generate_interfaces.cmake</span></code> 包 <code class="docutils literal notranslate"><span class="pre">rosidl_generator_cpp</span></code> 的扩展点 <code class="docutils literal notranslate"><span class="pre">rosidl_generate_interfaces</span></code> 。当执行扩展点时，这将在此处触发脚本 <code class="docutils literal notranslate"><span class="pre">rosidl_generator_cpp_generate_interfaces.cmake</span></code> 的执行。特别是，每当函数 <code class="docutils literal notranslate"><span class="pre">rosidl_generate_interfaces</span></code> 被执行时，这将调用生成器。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5853">[待校准&#64;5853]</a></p>
<p>除了 <code class="docutils literal notranslate"><span class="pre">rosidl_generate_interfaces</span></code> 之外，发电机最重要的扩展点是 <code class="docutils literal notranslate"><span class="pre">ament_package</span></code> ，它将简单地用 <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code> 调用执行脚本。在注册re源文件时，此扩展点非常有用 (见下文)。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5854">[待校准&#64;5854]</a></p>
<p>[需手动修复的语法]``ament_register_extension`` is函数采用三个参数: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5855">[待校准&#64;5855]</a></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">extension_point</span></code>: The name of the extension point (most of the time this will be one of <code class="docutils literal notranslate"><span class="pre">ament_package</span></code> or <code class="docutils literal notranslate"><span class="pre">rosidl_generate_interfaces</span></code>) <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5856">[待校准&#64;5856]</a></p></li>
<li><p>[需手动修复的语法]``package_name``:包含CMake文件的包的名称 (即文件写入项目的项目名称) <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5857">[待校准&#64;5857]</a></p></li>
<li><p>[需手动修复的语法]``cmake_filename``:CMake文件时执行扩展点运行 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5858">[待校准&#64;5858]</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>可以以类似于 <code class="docutils literal notranslate"><span class="pre">ament_package</span></code> 和 <code class="docutils literal notranslate"><span class="pre">rosidl_generate_interfaces</span></code> 的方式定义自定义扩展点，但这几乎没有必要。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5859">[待校准&#64;5859]</a></p>
</div>
</div>
<div class="section" id="adding-extension-points">
<h3>添加扩展点 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5860">[待校准&#64;5860]</a><a class="headerlink" href="#adding-extension-points" title="永久链接至标题"></a></h3>
<p>很少，定义一个新的ament延伸点可能会很有趣。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5861">[待校准&#64;5861]</a></p>
<p>扩展点可以在宏中注册，以便在调用相应的宏时执行所有扩展。为此: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5862">[待校准&#64;5862]</a></p>
<ul class="simple">
<li><p>定义并记录扩展的名称 (例如 <code class="docutils literal notranslate"><span class="pre">my_extension_point</span></code> )，这是使用扩展点时传递给 <code class="docutils literal notranslate"><span class="pre">ament_register_extension</span></code> 宏的名称。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5863">[待校准&#64;5863]</a></p></li>
<li><p>在应执行扩展调用的宏/函数中: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5864">[待校准&#64;5864]</a></p></li>
</ul>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">ament_execute_extensions</span><span class="p">(</span><span class="s">my_extension_point</span><span class="p">)</span>
</pre></div>
</div>
<p>[需手动修复的语法]Ament扩展的工作原理是定义一个包含扩展点名称的变量，并用要执行的宏填充它。调用 <code class="docutils literal notranslate"><span class="pre">ament_execute_extensions</span></code> 后，变量中定义的脚本将一个接一个地执行。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5865">[待校准&#64;5865]</a></p>
</div>
</div>
<div class="section" id="adding-resources">
<h2>添加re源文件 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5866">[待校准&#64;5866]</a><a class="headerlink" href="#adding-resources" title="永久链接至标题"></a></h2>
<p>尤其是在开发允许插件的插件或包时，通常必须将re源文件从另一个ROS包 (例如插件) 添加到一个ROS包中。示例可以是使用pluginlib的工具插件。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5867">[待校准&#64;5867]</a></p>
<p>这可以通过使用的ament指数 (也调用了  &quot;resource index&quot; )。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5868">[待校准&#64;5868]</a></p>
<div class="section" id="the-ament-index-explained">
<h3>ament指数解释 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5869">[待校准&#64;5869]</a><a class="headerlink" href="#the-ament-index-explained" title="永久链接至标题"></a></h3>
<p>有关设计和意图的详细信息，请参见 <a class="reference external" href="https://github.com/ament/ament_cmake/blob/foxy/ament_cmake_core/doc/resource_index.md">here</a>  <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5870">[待校准&#64;5870]</a></p>
<p>原则上，ament索引包含在包的安装/共享文件夹中的一个文件夹中。它包含以不同类型的re源文件命名的浅子文件夹。在子文件夹中，每个提供所述re源文件的包都以  &quot;marker file&quot; 名称引用。该文件可以包含获取re源文件所需的任何内容，例如到re源文件的安装目录的相对路径，它也可以简单地为空。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5871">[待校准&#64;5871]</a></p>
<p>举个例子，考虑为RViz提供显示插件: 当在一个名为 <code class="docutils literal notranslate"><span class="pre">my_rviz_displays</span></code> 的项目中提供RViz插件时，你将提供一个 <code class="docutils literal notranslate"><span class="pre">plugin_description.xml</span></code> 文件，它将由pluginlib安装并用于加载插件。为此，plugin_description.xml注册为重新源文件再次源文件 _ 指数通过 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5872">[待校准&#64;5872]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">pluginlib_export_plugin_description_file</span><span class="p">(</span><span class="s">rviz_common</span> <span class="s">plugins_description.xml</span><span class="p">)</span>
</pre></div>
</div>
<p>运行 <code class="docutils literal notranslate"><span class="pre">colcon</span> <span class="pre">build</span></code> 时，这会将文件 <code class="docutils literal notranslate"><span class="pre">my_rviz_displays</span></code> 安装到re源文件 _ index的子文件夹 <code class="docutils literal notranslate"><span class="pre">rviz_common__pluginlib__plugin</span></code> 中。rviz_common中的Pluginlib工厂将知道从所有名为 <code class="docutils literal notranslate"><span class="pre">rviz_common__pluginlib__plugin</span></code> 的文件夹中收集用于导出插件的包的信息。pluginlib工厂的标记文件包含 <code class="docutils literal notranslate"><span class="pre">plugins_description.xml</span></code> 文件的安装文件夹相对路径 (以及作为标记文件名的库名称)。有了这些信息，pluginlib可以加载库，并知道从 <code class="docutils literal notranslate"><span class="pre">plugin_description.xml</span></code> 文件加载哪些插件。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5873">[待校准&#64;5873]</a></p>
<p>作为第二个例子，考虑让你自己的RViz插件使用你自己的自定义网格的可能性。网格在启动时加载，因此插件所有者不必处理它，但这意味着RViz必须了解网格。为了实现这一点，RViz提供了一个功能: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5874">[待校准&#64;5874]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">register_rviz_ogre_media_exports</span><span class="p">(</span><span class="s">DIRECTORIES</span> <span class="s">&lt;my_dirs&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>这将目录注册为ament索引中的ogre_media re源文件。简而言之，它将一个以调用函数的项目命名的文件安装到调用 <code class="docutils literal notranslate"><span class="pre">rviz_ogre_media_exports</span></code> 的子文件夹中。该文件包含安装文件夹与宏中列出的目录的相对路径。在启动时，RViz现在可以搜索所有调用 <code class="docutils literal notranslate"><span class="pre">rviz_ogre_media_exports</span></code> 的文件夹，并在提供的所有文件夹中加载源文件。这些搜索是使用 <code class="docutils literal notranslate"><span class="pre">ament_index_cpp</span></code>  (或蟒蛇包的 <code class="docutils literal notranslate"><span class="pre">ament_index_py</span></code> ) 完成的。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5875">[待校准&#64;5875]</a></p>
<p>在以下各节中，我们将探讨如何将您自己的re源文件添加到ament索引中，并为此提供最佳实践。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5876">[待校准&#64;5876]</a></p>
</div>
<div class="section" id="querying-the-ament-index">
<h3>查询ament指数 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5877">[待校准&#64;5877]</a><a class="headerlink" href="#querying-the-ament-index" title="永久链接至标题"></a></h3>
<p>如有必要，可以通过CMake查询re源文件的ament索引。为此，有三个功能: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5878">[待校准&#64;5878]</a></p>
<p>[需手动修复的语法]``ament_index_has_resource``:获得前缀路径重新源文件如果存在以下参数: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5879">[待校准&#64;5879]</a></p>
<ul class="simple">
<li><p>[需手动修复的语法]``var``:输出参数: 如果re源文件不存在，则用FALSE填充此变量，否则用re源文件的前缀路径填充 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5880">[待校准&#64;5880]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resource_type</span></code>: The type of the resource (e.g. <code class="docutils literal notranslate"><span class="pre">rviz_common__pluginlib__plugin</span></code>) <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5881">[待校准&#64;5881]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resource_name</span></code>: The name of the resource which usually amounts to the name of the package having added the resource of type resource_type (e.g. <code class="docutils literal notranslate"><span class="pre">rviz_default_plugins</span></code>) <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5882">[待校准&#64;5882]</a></p></li>
</ul>
<p>[需手动修复的语法]``ament_index_get_resource``:获得特定re源文件的内容，即ament索引中标记文件的内容。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5883">[待校准&#64;5883]</a></p>
<ul class="simple">
<li><p>[需手动修复的语法]``var``:输出参数: 如果存在，则填充re源文件的内容。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5884">[待校准&#64;5884]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resource_type</span></code>: The type of the resource (e.g. <code class="docutils literal notranslate"><span class="pre">rviz_common__pluginlib__plugin</span></code>) <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5881">[待校准&#64;5881]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resource_name</span></code>: The name of the resource which usually amounts to the name of the package having added the resource of type resource_type (e.g. <code class="docutils literal notranslate"><span class="pre">rviz_default_plugins</span></code>) <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5882">[待校准&#64;5882]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PREFIX_PATH</span></code>: The prefix path to search for (usually, the default <code class="docutils literal notranslate"><span class="pre">ament_index_get_prefix_path()</span></code> will就够了)。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5885">[待校准&#64;5885]</a></p></li>
</ul>
<p>请注意，如果re源文件不存在， <code class="docutils literal notranslate"><span class="pre">ament_index_get_resource</span></code> 将引发错误，因此可能有必要使用 <code class="docutils literal notranslate"><span class="pre">ament_index_has_resource</span></code> 进行检查。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5886">[待校准&#64;5886]</a></p>
<p>[需手动修复的语法]``ament_index_get_resources``:从索引中获取注册特定类型的re源文件的所有包 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5887">[待校准&#64;5887]</a></p>
<ul class="simple">
<li><p>[需手动修复的语法]``var``:输出参数: 填充所有注册了re源文件类型的re源文件的包的名称列表 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5888">[待校准&#64;5888]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resource_type</span></code>: The type of the resource (e.g. <code class="docutils literal notranslate"><span class="pre">rviz_common__pluginlib__plugin</span></code>) <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5881">[待校准&#64;5881]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PREFIX_PATH</span></code>: The prefix path to search for (usually, the default <code class="docutils literal notranslate"><span class="pre">ament_index_get_prefix_path()</span></code> will就够了)。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5885">[待校准&#64;5885]</a></p></li>
</ul>
</div>
<div class="section" id="adding-to-the-ament-index">
<h3>添加到ament指数 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5889">[待校准&#64;5889]</a><a class="headerlink" href="#adding-to-the-ament-index" title="永久链接至标题"></a></h3>
<p>定义重新源文件需要两个信息: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5890">[待校准&#64;5890]</a></p>
<ul class="simple">
<li><p>re源文件的名称必须是唯一的， <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5891">[待校准&#64;5891]</a></p></li>
<li><p>标记文件的布局，可以是任何东西，也可以是空的 (例如，标记ROS 2包的  &quot;package&quot; re源文件也是如此) <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5892">[待校准&#64;5892]</a></p></li>
</ul>
<p>对于RViz网格re源文件，相应的选择是: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5893">[待校准&#64;5893]</a></p>
<ul class="simple">
<li><p>[需手动修复的语法]``rviz_ogre_media_exports`` asre源文件的名称， <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5894">[待校准&#64;5894]</a></p></li>
<li><p>安装包含re源文件的所有文件夹的路径相对路径。这将使您能够编写在包中使用相应re源文件的逻辑。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5895">[待校准&#64;5895]</a></p></li>
</ul>
<p>为了允许用户轻松注册包的re源文件，您还应该提供宏或函数，如pluginlib函数或 <code class="docutils literal notranslate"><span class="pre">rviz_ogre_media_exports</span></code> 函数。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5896">[待校准&#64;5896]</a></p>
<p>要注册re源文件，请使用ament函数 <code class="docutils literal notranslate"><span class="pre">ament_index_register_resource</span></code> 。这将在re源文件 _ index中创建和安装标记文件。例如，对 <code class="docutils literal notranslate"><span class="pre">rviz_ogre_media_exports</span></code> 的相应调用如下: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5897">[待校准&#64;5897]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">ament_index_register_resource</span><span class="p">(</span><span class="s">rviz_ogre_media_exports</span> <span class="s">CONTENT</span> <span class="o">${</span><span class="nv">OGRE_MEDIA_RESOURCE_FILE</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>这个安装文件像 ''${PROJECT_NAME} ”到一个文件夹 <code class="docutils literal notranslate"><span class="pre">rviz_ogre_media_exports</span></code> 到重新源文件 _ 指数内容给出变量 ''${OGRE_MEDIA_RESOURCE_FILE}”。该宏具有许多有用的参数: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5898">[待校准&#64;5898]</a></p>
<ul class="simple">
<li><p>第一个 (未命名) 参数是re源文件的名称，相当于re源文件 _ index中文件夹的名称 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5899">[待校准&#64;5899]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONTENT</span></code>: The content of the marker file as string. This could be a list of relative paths, etc. <code class="docutils literal notranslate"><span class="pre">CONTENT</span></code> cannot be used together with <code class="docutils literal notranslate"><span class="pre">CONTENT_FILE</span></code>. <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5900">[待校准&#64;5900]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONTENT_FILE</span></code>: The path to a file which will be use to create the marker file. The file can be a plain file or a template file expanded with <code class="docutils literal notranslate"><span class="pre">configure_file()</span></code>. <code class="docutils literal notranslate"><span class="pre">CONTENT_FILE</span></code> cannot be used together with <code class="docutils literal notranslate"><span class="pre">CONTENT</span></code>. <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5901">[待校准&#64;5901]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PACKAGE_NAME</span></code>: The name of the package/library exporting the resource, which amounts to the name of the marker file. Defaults to <code class="docutils literal notranslate"><span class="pre">${PROJECT_NAME}</span></code>. <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5902">[待校准&#64;5902]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AMENT_INDEX_BINARY_DIR</span></code>: The base path of the generated ament index. Unless really necessary, always use the default <code class="docutils literal notranslate"><span class="pre">${CMAKE_BINARY_DIR}/ament_cmake_index</span></code>. <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5903">[待校准&#64;5903]</a></p></li>
<li><p>[需手动修复的语法]``SKIP_INSTALL``:跳过安装标记文件。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5904">[待校准&#64;5904]</a></p></li>
</ul>
<p>由于每个包只存在一个标记文件，如果CMake函数/宏被同一项目调用两次通常是一个问题。但是，对于大型项目，最好拆分注册源文件的调用。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5905">[待校准&#64;5905]</a></p>
<p>因此，最好的做法是让注册re源文件 (如 <code class="docutils literal notranslate"><span class="pre">register_rviz_ogre_media_exports.cmake</span></code> ) 的宏只填充一些变量。然后，对 <code class="docutils literal notranslate"><span class="pre">ament_index_register_resource</span></code> 的真正调用可以添加到 <code class="docutils literal notranslate"><span class="pre">ament_package</span></code> 的ament扩展中。因为每个项目只能有一个对 <code class="docutils literal notranslate"><span class="pre">ament_package</span></code> 的调用，所以总是只有一个地方注册了re源文件。就 <code class="docutils literal notranslate"><span class="pre">rviz_ogre_media_exports</span></code> 而言，这相当于以下策略: <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5906">[待校准&#64;5906]</a></p>
<ul class="simple">
<li><p>宏 <code class="docutils literal notranslate"><span class="pre">register_rviz_ogre_media_exports</span></code> 获取文件夹列表，并将它们附加到调用ed <code class="docutils literal notranslate"><span class="pre">OGRE_MEDIA_RESOURCE_FILE</span></code> 的变量中。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5907">[待校准&#64;5907]</a></p></li>
<li><p>如果 “${OGRE_MEDIA_RESOURCE_FILE}” 为非空，则另一个宏调用ed <code class="docutils literal notranslate"><span class="pre">register_rviz_ogre_media_exports_hook</span></code> 调用s <code class="docutils literal notranslate"><span class="pre">ament_index_register_resource</span></code> 。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5908">[待校准&#64;5908]</a></p></li>
<li><p>通过调用， <code class="docutils literal notranslate"><span class="pre">register_rviz_ogre_media_exports_hook.cmake</span></code> 文件在第三文件 <code class="docutils literal notranslate"><span class="pre">register_rviz_ogre_media_exports_hook-extras.cmake</span></code> 中注册为ament扩展名 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5909">[待校准&#64;5909]</a></p></li>
</ul>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">ament_register_extension</span><span class="p">(</span><span class="s2">&quot;ament_package&quot;</span> <span class="s2">&quot;rviz_rendering&quot;</span>
  <span class="s2">&quot;register_rviz_ogre_media_exports_hook.cmake&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>文件 <code class="docutils literal notranslate"><span class="pre">register_rviz_ogre_media_exports.cmake</span></code> 和 <code class="docutils literal notranslate"><span class="pre">register_rviz_ogre_media_exports_hook-extra.cmake</span></code> 在 <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code> 注册为 <code class="docutils literal notranslate"><span class="pre">CONFIG_EXTRA</span></code> 。 <a class="reference external" href="http://dev.ros2.fishros.com/calibpage/#/home?msgid=5910">[待校准&#64;5910]</a></p></li>
</ul>
</div>
</div>
</div>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Developing-a-ROS-2-Package.html" class="btn btn-neutral float-left" title="开发ROS 2包 [待校准@6065]" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="Ament-CMake-Python-Documentation.html" class="btn btn-neutral float-right" title="ament_cmake_python用户文档 [小鱼@5911]" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, Open Robotics.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-17821189-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-17821189-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>