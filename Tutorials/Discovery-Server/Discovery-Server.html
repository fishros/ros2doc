<!DOCTYPE html>
<html class="writer-html5" lang="zh" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using Fast DDS Discovery Server as discovery protocol [community-contributed] &mdash; ROS 2 documentation  文档</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="https://docs.ros.org/en/Tutorials/Discovery-Server/Discovery-Server.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Implement a custom memory allocator" href="../Allocator-Template-Tutorial.html" />
    <link rel="prev" title="ROS 2 Topic Statistics Tutorial (C++)" href="../Topics/Topic-Statistics-Tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> ROS 2 documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Ubuntu-Development-Setup.html">Building ROS 2 on Ubuntu Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Ubuntu-Install-Binary.html">Installing ROS 2 on Ubuntu Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Ubuntu-Install-Debians.html">Installing ROS 2 via Debian Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/macOS-Development-Setup.html">Building ROS 2 on macOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/macOS-Install-Binary.html">Installing ROS 2 on macOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Windows-Development-Setup.html">Building ROS 2 on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Windows-Install-Binary.html">Installing ROS 2 on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Fedora-Development-Setup.html">Building ROS 2 on Fedora Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Latest-Development-Setup.html">Installing the latest ROS 2 development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Maintaining-a-Source-Checkout.html">Maintaining a source checkout of ROS 2 Rolling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/Testing.html">Alternative Installation Sources for Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Installation/DDS-Implementations.html">Installing DDS implementations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Install-Connext-Security-Plugins.html">Installing Connext security plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Install-Connext-University-Eval.html">Installing University or Evaluation versions of RTI Connext DDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-Eclipse-CycloneDDS.html">Working with Eclipse Cyclone DDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-GurumNetworks-GurumDDS.html">Working with GurumNetworks GurumDDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Installation/DDS-Implementations/Working-with-eProsima-Fast-DDS.html">Working with eProsima Fast DDS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Docs-Guide.html">Docs Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Configuring-ROS2-Environment.html">Configuring your ROS 2 environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Turtlesim/Introducing-Turtlesim.html">Introducing turtlesim and rqt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Understanding-ROS2-Nodes.html">Understanding ROS 2 nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Topics/Understanding-ROS2-Topics.html">Understanding ROS 2 topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Services/Understanding-ROS2-Services.html">Understanding ROS 2 services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parameters/Understanding-ROS2-Parameters.html">Understanding ROS 2 parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Understanding-ROS2-Actions.html">Understanding ROS 2 actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Rqt-Console/Using-Rqt-Console.html">Using rqt_console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Launch/CLI-Intro.html">Introducing ROS 2 launch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ros2bag/Recording-And-Playing-Back-Data.html">Recording and playing back data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Workspace/Creating-A-Workspace.html">Creating a workspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Creating-Your-First-ROS2-Package.html">Creating your first ROS 2 package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">Writing a simple publisher and subscriber (C++)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Writing-A-Simple-Py-Publisher-And-Subscriber.html">Writing a simple publisher and subscriber (Python)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Writing-A-Simple-Cpp-Service-And-Client.html">Writing a simple service and client (C++)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Writing-A-Simple-Py-Service-And-Client.html">Writing a simple service and client (Python)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Custom-ROS2-Interfaces.html">Creating custom ROS 2 msg and srv files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Single-Package-Define-And-Use-Interface.html">Expanding on ROS 2 interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Using-Parameters-In-A-Class-CPP.html">Using parameters in a class (C++)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Using-Parameters-In-A-Class-Python.html">Using parameters in a class (Python)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Getting-Started-With-Ros2doctor.html">Getting started with ros2doctor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Pluginlib.html">Creating and Using Plugins (C++)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Actions/Creating-an-Action.html">Creating an action</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Actions/Writing-a-Cpp-Action-Server-Client.html">Writing an action server and client (C++)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Actions/Writing-a-Py-Action-Server-Client.html">Writing an action server and client (Python)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Composition.html">Composing multiple nodes in a single process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Colcon-Tutorial.html">Using colcon to build packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Launch/Launch-Main.html">Launch Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Launch/Creating-Launch-Files.html">Creating a launch file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Launch/Launch-system.html">Launching/monitoring multiple nodes with Launch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Launch/Using-Substitutions.html">Using substitutions in launch files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Launch/Using-Event-Handlers.html">Using event handlers in launch files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Launch/Using-ROS2-Launch-For-Large-Projects.html">Using ROS 2 launch for large projects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Tf2/Tf2-Main.html">tf2 Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Introduction-To-Tf2.html">Introduction to tf2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Writing-A-Tf2-Static-Broadcaster-Py.html">Writing a tf2 static broadcaster (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Writing-A-Tf2-Static-Broadcaster-Cpp.html">Writing a tf2 static broadcaster (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Writing-A-Tf2-Broadcaster-Py.html">Writing a tf2 broadcaster (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Writing-A-Tf2-Broadcaster-Cpp.html">Writing a tf2 broadcaster (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Writing-A-Tf2-Listener-Py.html">Writing a tf2 listener (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Writing-A-Tf2-Listener-Cpp.html">Writing a tf2 listener (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Adding-A-Frame-Py.html">Adding a frame (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Adding-A-Frame-Cpp.html">Adding a frame (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Learning-About-Tf2-And-Time-Py.html">Learning about tf2 and time (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Learning-About-Tf2-And-Time-Cpp.html">Learning about tf2 and time (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Time-Travel-With-Tf2-Py.html">Time travel with tf2 (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Time-Travel-With-Tf2-Cpp.html">Time travel with tf2 (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Debugging-Tf2-Problems.html">Debugging tf2 problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Quaternion-Fundamentals.html">Quaternion fundamentals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Tf2/Using-Stamped-Datatypes-With-Tf2-Ros-MessageFilter.html">Using stamped datatypes with tf2_ros::MessageFilter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../URDF/URDF-Main.html">URDF Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../URDF/Building-a-Visual-Robot-Model-with-URDF-from-Scratch.html">Building a Visual Robot Model with URDF from Scratch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../URDF/Building-a-Movable-Robot-Model-with-URDF.html">Building a Movable Robot Model with URDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../URDF/Adding-Physical-and-Collision-Properties-to-a-URDF-Model.html">Adding Physical and Collision Properties to a URDF Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../URDF/Using-Xacro-to-Clean-Up-a-URDF-File.html">Using Xacro to Clean Up a URDF File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../URDF/Using-URDF-with-Robot-State-Publisher.html">Using URDF with robot_state_publisher</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Topics/Topic-Statistics-Tutorial.html">ROS 2 Topic Statistics Tutorial (C++)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Using Fast DDS Discovery Server as discovery protocol [community-contributed]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Allocator-Template-Tutorial.html">Implement a custom memory allocator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Simulators/Webots/Setting-up-a-Robot-Simulation-Webots.html">Setting-up a Robot Simulation (Webots)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Deploying-ROS-2-on-IBM-Cloud.html">ROS2 on IBM Cloud Kubernetes [community-contributed]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Eclipse-Oxygen-with-ROS-2-and-rviz2.html">Eclipse Oxygen with ROS 2 and rviz2 [community-contributed]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Building-Realtime-rt_preempt-kernel-for-ROS-2.html">Building realtime Linux for ROS 2 [community-contributed]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ros2bag/Recording-A-Bag-From-Your-Own-Node.html">Recording a bag from your own node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Building-ROS2-Package-with-eclipse-2021-06.html">Building ROS 2 Package with eclipse 2021-06</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Quality-of-Service.html">Use quality-of-service settings to handle lossy networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Managed-Nodes.html">Management of nodes with managed lifecycles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Intra-Process-Communication.html">Efficient intra-process communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Rosbag-with-ROS1-Bridge.html">Recording and playback of topic data with rosbag using the ROS 1 bridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Real-Time-Programming.html">Real-time programming in ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dummy-robot-demo.html">Trying the dummy robot demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Logging-and-logger-configuration.html">Logging and logger configuration demo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../How-To-Guides.html">How-to Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Installation-Troubleshooting.html">Installation troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Developing-a-ROS-2-Package.html">Developing a ROS 2 package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Ament-CMake-Documentation.html">ament_cmake user documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Ament-CMake-Python-Documentation.html">ament_cmake_python user documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launch-files-migration-guide.html">Migrating launch files from ROS 1 to ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launch-file-different-formats.html">Using Python, XML, and YAML for ROS 2 Launch Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Launching-composable-nodes.html">Using ROS 2 launch to launch composable nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Parameters-YAML-files-migration-guide.html">Migrating YAML parameter files from ROS 1 to ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Node-arguments.html">Passing ROS arguments to nodes via the command-line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Sync-Vs-Async.html">Synchronous vs. asynchronous service clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/DDS-tuning.html">DDS tuning information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Overriding-QoS-Policies-For-Recording-And-Playback.html">rosbag2: Overriding QoS Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Working-with-multiple-RMW-implementations.html">Working with multiple ROS 2 middleware implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Cross-compilation.html">Cross-compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Releasing-a-ROS-2-package-with-bloom.html">Releasing a ROS 2 package with bloom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-Python-Packages.html">Using Python Packages with ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/RQt-Port-Plugin-Windows.html">Porting RQt plugins to Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Run-2-nodes-in-single-or-separate-docker-containers.html">Running ROS 2 nodes in Docker [community-contributed]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Package-maintainer-guide.html">ROS 2 Package Maintainer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Building-a-Custom-Debian-Package.html">Building a custom Debian package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Topics-Services-Actions.html">Topics vs Services vs Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-Variants.html">Using variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/Using-ros2-param.html">Using the <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">param</span></code> command-line tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install.html">Building RQt from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install-MacOS.html">Building RQt from source on macOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../How-To-Guides/RQt-Source-Install-Windows10.html">Building RQt from source on Windows 10</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Concepts.html">Concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Domain-ID.html">The ROS_DOMAIN_ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Different-Middleware-Vendors.html">About different ROS 2 DDS/RTPS vendors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Logging.html">About logging and logger configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Quality-of-Service-Settings.html">About Quality of Service settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Client-Libraries.html">About ROS 2 client libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-Interfaces.html">About ROS 2 interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-ROS-2-Parameters.html">About parameters in ROS 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Executors.html">Executors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Topic-Statistics.html">About topic statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Command-Line-Tools.html">Introspection with command line tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-RQt.html">Overview and usage of RQt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Composition.html">About Composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Catment.html">On the mixing of ament and catkin (catment)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Cross-Compilation.html">About Cross-compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Tf2.html">About tf2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Build-System.html">About the build system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Internal-Interfaces.html">About internal ROS 2 interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Middleware-Implementations.html">About ROS 2 middleware implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Concepts/About-Client-Interfaces.html">ROS 2 Client Interfaces (Client Libraries)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Contributing/Developer-Guide.html">ROS 2 developer guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Contributing/Code-Style-Language-Versions.html">Code style and language versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Contributing/Quality-Guide.html">Quality guide: ensuring code quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Contributing/Migration-Guide.html">Migration guide from ROS 1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Contributing/Migration-Guide-Python.html">Python migration guide from ROS 1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Contributing/Build-Farms.html">ROS Build Farms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Contributing/Windows-Tips-and-Tricks.html">Windows Tips and Tricks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Contributing/Contributing-To-ROS-2-Documentation.html">Contributing to ROS 2 Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ROSCon-Content.html">ROSCon Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Releases.html">Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Alpha-Overview.html">ROS 2 alpha releases (Aug 2015 - Oct 2016)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Beta1-Overview.html">Beta 1 (codename 'Asphalt'; December 2016)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Beta2-Overview.html">Beta 2 (codename 'r2b2'; July 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Beta3-Overview.html">Beta 3 (codename 'r2b3'; September 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Ardent-Apalone.html">ROS 2 Ardent Apalone (codename 'ardent'; December 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Bouncy-Bolson.html">ROS 2 Bouncy Bolson (codename 'bouncy'; June 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Crystal-Clemmys.html">ROS 2 Crystal Clemmys (codename 'crystal'; December 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Dashing-Diademata.html">ROS 2 Dashing Diademata (codename 'dashing'; May 31st, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Eloquent-Elusor.html">ROS 2 Eloquent Elusor (codename 'eloquent'; November 22nd, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Foxy-Fitzroy.html">ROS 2 Foxy Fitzroy (codename 'foxy'; June 5th, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Galactic-Geochelone.html">ROS 2 Galactic Geochelone (codename 'galactic'; May, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Galactic-Geochelone-Complete-Changelog.html">ROS 2 Galactic Geochelone Complete Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Humble-Hawksbill.html">ROS 2 Humble Hawksbill (codename 'humble'; May, 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Releases/Release-Rolling-Ridley.html">ROS 2 Rolling Ridley (codename 'rolling'; June 2020)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Features.html">Features Status</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Feature-Ideas.html">Feature Ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Governance.html">Project Governance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Governance/ROS2-TSC-Charter.html">ROS 2 Technical Steering Committee Charter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Governance/ROS2-TSC-Intake-process.html">ROS 2 TSC applicant intake process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Governance/How-To-Start-A-Community-Working-Group.html">How to Start a Community Working Group</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Marketing.html">Marketing Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Related-Projects.html">Related Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Related-Projects/Intel-ROS2-Projects.html">Intel ROS 2 Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Related-Projects/Nvidia-ROS2-Projects.html">NVIDIA ROS 2 Projects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ROS 2 documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../Tutorials.html">Tutorials</a> &raquo;</li>
      <li>Using Fast DDS Discovery Server as discovery protocol [community-contributed]</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ros2/ros2_documentation/blob/rolling/source/Tutorials/Discovery-Server/Discovery-Server.rst" class="fa fa-github"> 在 GitHub 上修改</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             


  <section id="using-fast-dds-discovery-server-as-discovery-protocol-community-contributed">
<h1>Using Fast DDS Discovery Server as discovery protocol [community-contributed]<a class="headerlink" href="#using-fast-dds-discovery-server-as-discovery-protocol-community-contributed" title="永久链接至标题"></a></h1>
<p><strong>Goal:</strong> This tutorial will show how to launch ROS 2 Nodes using the <strong>Fast DDS Discovery Server</strong> discovery protocol.</p>
<p><strong>Tutorial level:</strong> Intermediate</p>
<p><strong>Time:</strong> 20 minutes</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#background" id="id1">Background</a></p></li>
<li><p><a class="reference internal" href="#fast-dds-discovery-server-v2" id="id2">Fast DDS Discovery Server v2</a></p></li>
<li><p><a class="reference internal" href="#prerequisites" id="id3">Prerequisites</a></p></li>
<li><p><a class="reference internal" href="#run-this-tutorial" id="id4">Run this tutorial</a></p>
<ul>
<li><p><a class="reference internal" href="#setup-discovery-server" id="id5">Setup Discovery Server</a></p></li>
<li><p><a class="reference internal" href="#launch-listener-node" id="id6">Launch listener node</a></p></li>
<li><p><a class="reference internal" href="#launch-talker-node" id="id7">Launch talker node</a></p></li>
<li><p><a class="reference internal" href="#demonstrate-discovery-server-execution" id="id8">Demonstrate Discovery Server execution</a></p></li>
<li><p><a class="reference internal" href="#visualization-tool-rqt-graph" id="id9">Visualization tool <code class="docutils literal notranslate"><span class="pre">rqt_graph</span></code></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#advance-use-cases" id="id10">Advance use cases</a></p>
<ul>
<li><p><a class="reference internal" href="#server-redundancy" id="id11">Server Redundancy</a></p></li>
<li><p><a class="reference internal" href="#backup-server" id="id12">Backup Server</a></p></li>
<li><p><a class="reference internal" href="#discovery-partitions" id="id13">Discovery partitions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#compare-fast-dds-discovery-server-with-simple-discovery-protocol" id="id14">Compare Fast DDS Discovery Server with Simple Discovery Protocol</a></p></li>
</ul>
</div>
<section id="background">
<h2><a class="toc-backref" href="#id1">Background</a><a class="headerlink" href="#background" title="永久链接至标题"></a></h2>
<p>Starting from ROS 2 Eloquent Elusor, the <strong>Fast DDS Discovery Server</strong> protocol is a feature that offers a centralized dynamic discovery mechanism, as opposed to the distributed mechanism used in DDS by default.
This tutorial explains how to run some ROS 2 examples using the Fast DDS Discovery Server feature as discovery communication.</p>
<p>In order to get more information about the available discovery configuration, please check the <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/v2.1.0/fastdds/discovery/discovery.html">following documentation</a> or read the <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/v2.1.0/fastdds/discovery/discovery_server.html#discovery-server">Fast DDS Discovery Server specific documentation</a>.</p>
<p>The <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/v2.1.0/fastdds/discovery/simple.html">Simple Discovery Protocol</a> is the standard protocol defined in the <a class="reference external" href="https://www.omg.org/omg-dds-portal/">DDS standard</a>.
However, it has known disadvantages in some scenarios.</p>
<ul class="simple">
<li><p>It does not <strong>Scale</strong> efficiently, as the number of exchanged packets increases significantly as new nodes are added.</p></li>
<li><p>It requires <strong>multicasting</strong> capabilities that may not work reliably in some scenarios, e.g. WiFi.</p></li>
</ul>
<p>The <strong>Fast DDS Discovery Server</strong> provides a Client-Server Architecture that allows nodes to connect with each other using an intermediate server.
Each node functions as a <em>discovery client</em>, sharing its info with one or more <em>discovery servers</em> and receiving discovery information from it.
This reduces discovery-related network traffic and it does not require multicasting capabilities.</p>
<img alt="../../_images/ds_explanation.svg" class="align-center" src="../../_images/ds_explanation.svg" /><p>These discovery servers can be independent, duplicated or connected with each other in order to create redundancy over the network and avoid having a single point of failure.</p>
</section>
<section id="fast-dds-discovery-server-v2">
<h2><a class="toc-backref" href="#id2">Fast DDS Discovery Server v2</a><a class="headerlink" href="#fast-dds-discovery-server-v2" title="永久链接至标题"></a></h2>
<p>The latest ROS 2 Foxy Fitzroy release (December 2020) included a new version, version 2 of the Fast DDS Discovery Server.
This version includes a new filter feature that further reduces the number of discovery messages sent.
This version uses the topic of the different nodes to decide if two nodes wish to communicate, or if they can be left unmatched (i.e. not discovering each other).
The following figure shows the decrease in discovery messages:</p>
<img alt="../../_images/ds1vs2.svg" class="align-center" src="../../_images/ds1vs2.svg" /><p>This architecture reduces the number of messages sent between the server and clients dramatically.
In the following graph, the reduction in network traffic over the discovery phase for the <a class="reference external" href="https://github.com/osrf/rmf_demos#Clinic-World">RMF Clinic demonstration</a> is shown:</p>
<img alt="../../_images/discovery_server_v2_performance.svg" class="align-center" src="../../_images/discovery_server_v2_performance.svg" /><p>In order to use this functionality, the discovery server can be configured using the <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/v2.1.0/fastdds/discovery/discovery_server.html#discovery-server">XML configuration for Participants</a>.
It is also possible to configure the discovery server using the <code class="docutils literal notranslate"><span class="pre">fastdds</span></code> <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/v2.1.0/fastddscli/cli/cli.html#discovery">tool</a> and an <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/v2.1.0/fastdds/env_vars/env_vars.html">environment variable</a>, which is the approach used in this tutorial.
For a more detailed explanation about the configuration of the discovery server, visit <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/v2.1.0/fastdds/discovery/discovery_server.html#discovery-server">the Fast DDS Discovery Server documentation</a>.</p>
</section>
<section id="prerequisites">
<h2><a class="toc-backref" href="#id3">Prerequisites</a><a class="headerlink" href="#prerequisites" title="永久链接至标题"></a></h2>
<p>This tutorial assumes you have a ROS 2 Foxy (or newer) <a class="reference internal" href="../../Installation.html"><span class="doc">installation</span></a>.
If your installation is using a ROS 2 version lower than Foxy, you cannot use the <code class="docutils literal notranslate"><span class="pre">fastdds</span></code> tool.
Thus, in order to use the Discovery Server, you can update your repository to use a different Fast DDS version, or configure the discovery server using the <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/v2.1.0/fastdds/discovery/discovery_server.html#discovery-server">Fast DDS XML QoS configuration</a>.</p>
</section>
<section id="run-this-tutorial">
<h2><a class="toc-backref" href="#id4">Run this tutorial</a><a class="headerlink" href="#run-this-tutorial" title="永久链接至标题"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">talker-listener</span></code> ROS 2 demo creates a <code class="docutils literal notranslate"><span class="pre">talker</span></code> node that publishes a &quot;hello world&quot; message every second, and a <code class="docutils literal notranslate"><span class="pre">listener</span></code> node that listens to these messages.</p>
<p>By <a class="reference internal" href="../Configuring-ROS2-Environment.html"><span class="doc">sourcing ROS 2</span></a> you will get access to the CLI tool <code class="docutils literal notranslate"><span class="pre">fastdds</span></code>.
This tool gives access to the <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/v2.1.0/fastddscli/cli/cli.html#discovery">discovery tool</a>, which can be used to launch a discovery server. This server will manage the discovery process for the nodes that connect to it.</p>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>Do not forget to <a class="reference internal" href="../Configuring-ROS2-Environment.html"><span class="doc">source ROS 2</span></a> in every new terminal opened.</p>
</div>
<section id="setup-discovery-server">
<h3><a class="toc-backref" href="#id5">Setup Discovery Server</a><a class="headerlink" href="#setup-discovery-server" title="永久链接至标题"></a></h3>
<p>Start by launching a discovery server with id 0, port 11811 (default port) and listening on all available interfaces.</p>
<p>Open a new terminal and run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fastdds discovery --server-id 0</span>
</pre></div>
</div>
</section>
<section id="launch-listener-node">
<h3><a class="toc-backref" href="#id6">Launch listener node</a><a class="headerlink" href="#launch-listener-node" title="永久链接至标题"></a></h3>
<p>Execute the listener demo, to listen to the <code class="docutils literal notranslate"><span class="pre">/chatter</span></code> topic.</p>
<p>In a new terminal, set the environment variable <code class="docutils literal notranslate"><span class="pre">ROS_DISCOVERY_SERVER</span></code> to the location of the discovery server.
(Do not forget to source ROS 2 in every new terminal)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export ROS_DISCOVERY_SERVER=127.0.0.1:11811</span>
</pre></div>
</div>
<p>Launch the listener node. Use the argument <code class="docutils literal notranslate"><span class="pre">--remap</span> <span class="pre">__node:=listener_discovery_server</span></code> to change the node's name for this tutorial.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run demo_nodes_cpp listener --ros-args --remap __node:=listener_discovery_server</span>
</pre></div>
</div>
<p>This will create a ROS 2 node, that will automatically create a client for the discovery server and connect to the server created previously to perform discovery, rather than using multicast.</p>
</section>
<section id="launch-talker-node">
<h3><a class="toc-backref" href="#id7">Launch talker node</a><a class="headerlink" href="#launch-talker-node" title="永久链接至标题"></a></h3>
<p>Open a new terminal and set the <code class="docutils literal notranslate"><span class="pre">ROS_DISCOVERY_SERVER</span></code> environment variable as before so that the node starts a discovery client.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export ROS_DISCOVERY_SERVER=127.0.0.1:11811</span>
<span class="go">ros2 run demo_nodes_cpp talker --ros-args --remap __node:=talker_discovery_server</span>
</pre></div>
</div>
<p>You should now see the talker publishing &quot;hello world&quot; messages, and the listener receiving these messages.</p>
</section>
<section id="demonstrate-discovery-server-execution">
<h3><a class="toc-backref" href="#id8">Demonstrate Discovery Server execution</a><a class="headerlink" href="#demonstrate-discovery-server-execution" title="永久链接至标题"></a></h3>
<p>So far, there is no evidence that this example and the standard talker-listener example are running differently.
To clearly demonstrate this, run another node that is not connected to the discovery server.
Run a new listener (listening in <code class="docutils literal notranslate"><span class="pre">/chatter</span></code> topic by default) in a new terminal and check that it is not connected to the talker already running.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run demo_nodes_cpp listener --ros-args --remap __node:=simple_listener</span>
</pre></div>
</div>
<p>The new listener node should not be receiving the &quot;hello world&quot; messages.</p>
<p>To finally verify that everything is running correctly, a new talker can be created using the simple discovery protocol (the default DDS distributed discovery mechanism) for discovery.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run demo_nodes_cpp talker --ros-args --remap __node:=simple_talker</span>
</pre></div>
</div>
<p>Now you should see the <code class="docutils literal notranslate"><span class="pre">simple_listener</span></code> node receiving the &quot;hello world&quot; messages from <code class="docutils literal notranslate"><span class="pre">simple_talker</span></code> but not the other messages from <code class="docutils literal notranslate"><span class="pre">talker_discovery_server</span></code>.</p>
</section>
<section id="visualization-tool-rqt-graph">
<h3><a class="toc-backref" href="#id9">Visualization tool <code class="docutils literal notranslate"><span class="pre">rqt_graph</span></code></a><a class="headerlink" href="#visualization-tool-rqt-graph" title="永久链接至标题"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rqt_graph</span></code> tool can be used to verify the nodes and structure of this example.
Remember, in order to use <code class="docutils literal notranslate"><span class="pre">rqt_graph</span></code> with the discovery server protocol (i.e., to see the <code class="docutils literal notranslate"><span class="pre">listener_discovery_server</span></code> and <code class="docutils literal notranslate"><span class="pre">talker_discovery_server</span></code> nodes) the <code class="docutils literal notranslate"><span class="pre">ROS_DISCOVERY_SERVER</span></code> environment variable must be set before launching it.</p>
</section>
</section>
<section id="advance-use-cases">
<h2><a class="toc-backref" href="#id10">Advance use cases</a><a class="headerlink" href="#advance-use-cases" title="永久链接至标题"></a></h2>
<p>The following sections show different features of the discovery server that allow you to build a robust discovery server over the network.</p>
<section id="server-redundancy">
<h3><a class="toc-backref" href="#id11">Server Redundancy</a><a class="headerlink" href="#server-redundancy" title="永久链接至标题"></a></h3>
<p>By using <code class="docutils literal notranslate"><span class="pre">fastdds</span></code> tool, multiple discovery servers can be created.
Discovery clients (ROS nodes) can connect to as many servers as desired.
This allows to have a redundant network that will work even if some servers or nodes shut down unexpectedly.
The figure below shows a simple architecture that provides server redundancy.</p>
<img alt="../../_images/ds_redundancy_example.svg" class="align-center" src="../../_images/ds_redundancy_example.svg" /><p>In several terminals, run the following code to establish a communication with redundant servers.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fastdds discovery --server-id 0 --ip-address 127.0.0.1 --port 11811</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fastdds discovery --server-id 1 --ip-address 127.0.0.1 --port 11888</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">--server-id</span> <span class="pre">N</span></code> means server with id N. When referencing the servers with <code class="docutils literal notranslate"><span class="pre">ROS_DISCOVERY_SERVER</span></code>, server <code class="docutils literal notranslate"><span class="pre">0</span></code> must be in first place and server <code class="docutils literal notranslate"><span class="pre">1</span></code> in second place.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export ROS_DISCOVERY_SERVER=&quot;127.0.0.1:11811;127.0.0.1:11888&quot;</span>
<span class="go">ros2 run demo_nodes_cpp talker --ros-args --remap __node:=talker</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export ROS_DISCOVERY_SERVER=&quot;127.0.0.1:11811;127.0.0.1:11888&quot;</span>
<span class="go">ros2 run demo_nodes_cpp listener --ros-args --remap __node:=listener</span>
</pre></div>
</div>
<p>Now, if one of these servers fails, there will still be discovery capability available and nodes will still discover each other.</p>
</section>
<section id="backup-server">
<h3><a class="toc-backref" href="#id12">Backup Server</a><a class="headerlink" href="#backup-server" title="永久链接至标题"></a></h3>
<p>The Fast DDS Discovery Server allows creating a server with backup functionality.
This allows the server to restore the last state it saved in case of a shutdown.</p>
<img alt="../../_images/ds_backup_example.svg" class="align-center" src="../../_images/ds_backup_example.svg" /><p>In different terminals, run the following code to establish a communication with a backed-up server.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fastdds discovery --server-id 0 --ip-address 127.0.0.1 --port 11811 --backup</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export ROS_DISCOVERY_SERVER=&quot;127.0.0.1:11811&quot;</span>
<span class="go">ros2 run demo_nodes_cpp talker --ros-args --remap __node:=talker</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export ROS_DISCOVERY_SERVER=&quot;127.0.0.1:11811&quot;</span>
<span class="go">ros2 run demo_nodes_cpp listener --ros-args --remap __node:=listener</span>
</pre></div>
</div>
<p>Several backup files are created in the discovery server's working directory (the directory it was launched in).
The two <code class="docutils literal notranslate"><span class="pre">SQLite</span></code> files and two <code class="docutils literal notranslate"><span class="pre">json</span></code> files contain the information required to start a new server and restore the failed server's state in case of failure, avoiding the need for the discovery process to happen again, and without losing information.</p>
</section>
<section id="discovery-partitions">
<h3><a class="toc-backref" href="#id13">Discovery partitions</a><a class="headerlink" href="#discovery-partitions" title="永久链接至标题"></a></h3>
<p>Communication with discovery servers can be split to create virtual partitions in the discovery information.
This means that two endpoints will only know about each other if there is a shared discovery server or a network of discovery servers between them.
We are going to execute an example with two independent servers.
The following figure shows the architecture.</p>
<img alt="../../_images/ds_partition_example.svg" class="align-center" src="../../_images/ds_partition_example.svg" /><p>With this schema <code class="docutils literal notranslate"><span class="pre">Listener</span> <span class="pre">1</span></code> will be connected to <code class="docutils literal notranslate"><span class="pre">Talker</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">Talker</span> <span class="pre">2</span></code>, as they share <code class="docutils literal notranslate"><span class="pre">Server</span> <span class="pre">1</span></code>.
<code class="docutils literal notranslate"><span class="pre">Listener</span> <span class="pre">2</span></code> will connect with <code class="docutils literal notranslate"><span class="pre">Talker</span> <span class="pre">1</span></code> as they share <code class="docutils literal notranslate"><span class="pre">Server</span> <span class="pre">2</span></code>.
But <code class="docutils literal notranslate"><span class="pre">Listener</span> <span class="pre">2</span></code> will not hear the messages from <code class="docutils literal notranslate"><span class="pre">Talker</span> <span class="pre">2</span></code> because they do not share any discovery server or discovery servers, including indirectly via connections between redundant discovery servers.</p>
<p>Run the first server listening on localhost with the default port of 11811.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fastdds discovery --server-id 0 --ip-address 127.0.0.1 --port 11811</span>
</pre></div>
</div>
<p>In another terminal run the second server listening on localhost using another port, in this case port 11888.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">fastdds discovery --server-id 1 --ip-address 127.0.0.1 --port 11888</span>
</pre></div>
</div>
<p>Now, run each node in a different terminal. Use <code class="docutils literal notranslate"><span class="pre">ROS_DISCOVERY_SERVER</span></code> environment variable to decide which server they are connected to. Be aware that the <a class="reference external" href="https://fast-dds.docs.eprosima.com/en/v2.1.0/fastdds/env_vars/env_vars.html">ids must match</a>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export ROS_DISCOVERY_SERVER=&quot;127.0.0.1:11811;127.0.0.1:11888&quot;</span>
<span class="go">ros2 run demo_nodes_cpp talker --ros-args --remap __node:=talker_1</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export ROS_DISCOVERY_SERVER=&quot;127.0.0.1:11811;127.0.0.1:11888&quot;</span>
<span class="go">ros2 run demo_nodes_cpp listener --ros-args --remap __node:=listener_1</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export ROS_DISCOVERY_SERVER=&quot;127.0.0.1:11811&quot;</span>
<span class="go">ros2 run demo_nodes_cpp talker --ros-args --remap __node:=talker_2</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export ROS_DISCOVERY_SERVER=&quot;;127.0.0.1:11888&quot;</span>
<span class="go">ros2 run demo_nodes_cpp listener --ros-args --remap __node:=listener_2</span>
</pre></div>
</div>
<p>We should see how <code class="docutils literal notranslate"><span class="pre">Listener</span> <span class="pre">1</span></code> is receiving messages from both talker nodes, while <code class="docutils literal notranslate"><span class="pre">Listener</span> <span class="pre">2</span></code> is in a different partition from <code class="docutils literal notranslate"><span class="pre">Talker</span> <span class="pre">2</span></code> and so does not receive messages from it.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Once two endpoints (ROS nodes) have discovered each other, they do not need the discovery server network between them to listen to each other's messages.</p>
</div>
</section>
</section>
<section id="compare-fast-dds-discovery-server-with-simple-discovery-protocol">
<h2><a class="toc-backref" href="#id14">Compare Fast DDS Discovery Server with Simple Discovery Protocol</a><a class="headerlink" href="#compare-fast-dds-discovery-server-with-simple-discovery-protocol" title="永久链接至标题"></a></h2>
<p>In order to compare executing nodes using the Simple Discovery Protocol (the default DDS mechanism for distributed discovery) or the discovery server, two scripts that execute a talker and many listeners and analyze the network traffic during this time are provided.
For this experiment, <code class="docutils literal notranslate"><span class="pre">tshark</span></code> is required to be installed on your system.
The configuration file is mandatory in order to avoid using intraprocess mode.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>These scripts require a discovery server closure feature that is only available from versions newer than the version provided in ROS 2 Foxy.
In order to use this functionality, compile ROS 2 with Fast DDS v2.1.0 or higher.</p>
</div>
<p>These scripts' features are references for advanced purposes and their study is left to the user.</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../../_downloads/ad4519121a351c00b85e86ff01a4d54f/generate_discovery_packages.bash"><code class="xref download docutils literal notranslate"><span class="pre">bash</span> <span class="pre">network</span> <span class="pre">traffic</span> <span class="pre">generator</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../_downloads/4147240a509b185e34adb1b0fe9320dd/discovery_packets.py"><code class="xref download docutils literal notranslate"><span class="pre">python3</span> <span class="pre">graph</span> <span class="pre">generator</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../_downloads/0b98d1b30b08762953ff15b80a8c3a73/no_intraprocess_configuration.xml"><code class="xref download docutils literal notranslate"><span class="pre">XML</span> <span class="pre">configuration</span></code></a></p></li>
</ul>
<p>Run the bash script with the path to <code class="docutils literal notranslate"><span class="pre">setup.bash</span></code> file to source ROS 2 as an argument.
This will generate the traffic trace for simple discovery.
Execute the same script with second argument <code class="docutils literal notranslate"><span class="pre">SERVER</span></code>.
It will generate the trace for using the discovery server.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Depending on your configuration of <code class="docutils literal notranslate"><span class="pre">tcpdump</span></code>, this script may require <code class="docutils literal notranslate"><span class="pre">sudo</span></code> privileges to read traffic across your network device.</p>
</div>
<p>After both executions are done, run the Python script to generate a graph similar to the one below.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">export</span> <span class="nv">FASTRTPS_DEFAULT_PROFILES_FILE</span><span class="o">=</span><span class="s2">&quot;no_intraprocess_configuration.xml&quot;</span>
<span class="gp">$ </span>sudo bash generate_discovery_packages.bash ~/ros2_foxy/install/local_setup.bash
<span class="gp">$ </span>sudo bash generate_discovery_packages.bash ~/ros2_foxy/install/local_setup.bash SERVER
<span class="gp">$ </span>python3 discovery_packets.py
</pre></div>
</div>
<img alt="../../_images/discovery_packets.svg" class="align-center" src="../../_images/discovery_packets.svg" /><p>This graph is the result of a specific run of the experiment.
The reader can execute the scripts and generate their own results for comparison.
It can easily be seen that network traffic is reduced when using discovery service.</p>
<p>The reduction in traffic is a result of avoiding every node announcing itself and waiting a response from every other node on the network.
This creates a huge amount of traffic in large architectures.
The reduction from this method increases with the number of nodes, making this architecture more scalable than the Simple Discovery Protocol approach.</p>
<p>The new Fast DDS Discovery Server v2 is available since <em>Fast DDS</em> v2.0.2, replacing the old discovery server.
In this new version, those nodes that do not share topics will automatically not discover each other, saving the whole discovery data required to connect them and their endpoints.
The experiment above does not show this case, but even so the massive reduction in traffic can be appreciated due to the hidden infrastructure topics of ROS 2 nodes.</p>
</section>
</section>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../Topics/Topic-Statistics-Tutorial.html" class="btn btn-neutral float-left" title="ROS 2 Topic Statistics Tutorial (C++)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="../Allocator-Template-Tutorial.html" class="btn btn-neutral float-right" title="Implement a custom memory allocator" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, Open Robotics.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-17821189-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-17821189-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>